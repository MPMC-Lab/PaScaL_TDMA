<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: /Users/jihoon/Documents/develop/pascal_tdma/examples/mpi_subdomain.f90 Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_f396504afdc959660871b003fa10164d.html">Documents</a></li><li class="navelem"><a class="el" href="dir_4d30140f9922a921f935e93bb35111fb.html">develop</a></li><li class="navelem"><a class="el" href="dir_81e1d413a76d72fea0691456f7da03f8.html">pascal_tdma</a></li><li class="navelem"><a class="el" href="dir_318f63b1363a960dd8a55c9dc98d339f.html">examples</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">mpi_subdomain.f90</div>  </div>
</div><!--header-->
<div class="contents">
<a href="mpi__subdomain_8f90.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">!!======================================================================================================================</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">!======================================================================================================================</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno"><a class="line" href="namespacempi__subdomain.html">   25</a></span>&#160;<span class="keyword">module</span> <a class="code" href="namespacempi__subdomain.html">mpi_subdomain</a></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="keywordtype">use </span>mpi</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceglobal.html">global</a></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacempi__topology.html">mpi_topology</a>, <span class="keywordtype">only</span> : <a class="code" href="structmpi__topology_1_1cart__comm__1d.html">cart_comm_1d</a></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keywordtype">implicit none</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    </div><div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="namespacempi__subdomain.html#acd16f258caed20a7d8d38cd28ae64688">   33</a></span>&#160;    <span class="keywordtype">integer</span> :: <a class="code" href="namespacempi__subdomain.html#acd16f258caed20a7d8d38cd28ae64688">ierr</a></div><div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="namespacempi__subdomain.html#a07555cc931ac78376a4c81207662251f">   35</a></span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">public</span> :: <a class="code" href="namespacempi__subdomain.html#a005fe127fe0fc85b932814a820a36444">nx_sub</a>,<a class="code" href="namespacempi__subdomain.html#a665ba05d0ae9309dd28b9b513a0c87a1">ny_sub</a>,<a class="code" href="namespacempi__subdomain.html#a07555cc931ac78376a4c81207662251f">nz_sub</a></div><div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="namespacempi__subdomain.html#acd499eb1d07159aa9f5c878f9519b00f">   38</a></span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">public</span> :: <a class="code" href="namespacempi__subdomain.html#ab8925faaa6f45326c1d11efa37e03566">ista</a>, <a class="code" href="namespacempi__subdomain.html#abbd7d35107c53bcfd2b2b52771f4aa67">iend</a>, <a class="code" href="namespacempi__subdomain.html#ac85bfba1caf77f9c3c0047fe9450fee6">jsta</a>, <a class="code" href="namespacempi__subdomain.html#a06433a0d1a081c51202a0010c21c9d36">jend</a>, <a class="code" href="namespacempi__subdomain.html#acd499eb1d07159aa9f5c878f9519b00f">ksta</a>, <a class="code" href="namespacempi__subdomain.html#af9934313b1ccbcb09f30916df3326076">kend</a></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="namespacempi__subdomain.html#aab6d78e49471a9a3db5ad9df4c3d4041">   42</a></span>&#160;    <span class="keywordtype">double precision</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">public</span>     :: <a class="code" href="namespacempi__subdomain.html#a978554e1520c79471ef3793ed1872b37">x_sub</a>, <a class="code" href="namespacempi__subdomain.html#a58b09abee5f1002de7b20b1b86f5c821">y_sub</a>, <a class="code" href="namespacempi__subdomain.html#aab6d78e49471a9a3db5ad9df4c3d4041">z_sub</a></div><div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="namespacempi__subdomain.html#afb6341d7362587d6fd0a06fe78ba4e3f">   45</a></span>&#160;    <span class="keywordtype">double precision</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">public</span>     :: <a class="code" href="namespacempi__subdomain.html#a56af1740899dc9df6868e5e71a0884a5">dmx_sub</a>, <a class="code" href="namespacempi__subdomain.html#ae44efbff9669bfad03a79ab41b5e8ace">dmy_sub</a>, <a class="code" href="namespacempi__subdomain.html#afb6341d7362587d6fd0a06fe78ba4e3f">dmz_sub</a></div><div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="namespacempi__subdomain.html#ad61f27caf5f32301a077e21363c2d73b">   47</a></span>&#160;    <span class="keywordtype">double precision</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:,:)</span>, <span class="keywordtype">public</span>   :: <a class="code" href="namespacempi__subdomain.html#ad61f27caf5f32301a077e21363c2d73b">thetabc3_sub</a></div><div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="namespacempi__subdomain.html#ad1705bede0c0d39ad16f9f94afe32be6">   48</a></span>&#160;    <span class="keywordtype">double precision</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:,:)</span>, <span class="keywordtype">public</span>   :: <a class="code" href="namespacempi__subdomain.html#ad1705bede0c0d39ad16f9f94afe32be6">thetabc4_sub</a></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="namespacempi__subdomain.html#ac22380b1c941dd6c53cabe7287d185e9">   50</a></span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">public</span>  :: <a class="code" href="namespacempi__subdomain.html#ac22380b1c941dd6c53cabe7287d185e9">jmbc_index</a></div><div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="namespacempi__subdomain.html#a9adbfdd11c7e9fdb968bb8eef2b13c2b">   51</a></span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">public</span>  :: <a class="code" href="namespacempi__subdomain.html#a9adbfdd11c7e9fdb968bb8eef2b13c2b">jpbc_index</a></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="namespacempi__subdomain.html#a0701fde01daea1a6fd51b62c75b8ee82">   54</a></span>&#160;    <span class="keywordtype">integer</span> :: <a class="code" href="namespacempi__subdomain.html#a93395266b1630e5a91e8e89531dfcec6">ddtype_sendto_e</a>, <a class="code" href="namespacempi__subdomain.html#a0b2a4ab6d6a88a3817f473a5c2c172b9">ddtype_recvfrom_w</a>, <a class="code" href="namespacempi__subdomain.html#a0701fde01daea1a6fd51b62c75b8ee82">ddtype_sendto_w</a>, <a class="code" href="namespacempi__subdomain.html#a18a84c0f3ca27cd4dd73057ff035f341">ddtype_recvfrom_e</a></div><div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="namespacempi__subdomain.html#a660f83d621188fb7eb60ad10eab4c9b5">   57</a></span>&#160;    <span class="keywordtype">integer</span> :: <a class="code" href="namespacempi__subdomain.html#a55f5c1af9bd941fd176e619bddbb8d82">ddtype_sendto_n</a>, <a class="code" href="namespacempi__subdomain.html#a1f46916f08758533cad3ecac33233e38">ddtype_recvfrom_s</a>, <a class="code" href="namespacempi__subdomain.html#a660f83d621188fb7eb60ad10eab4c9b5">ddtype_sendto_s</a>, <a class="code" href="namespacempi__subdomain.html#a74f1edb3c9227692b250285680518dc4">ddtype_recvfrom_n</a></div><div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="namespacempi__subdomain.html#a4f3d66535b947c7afee75e6e73a47206">   60</a></span>&#160;    <span class="keywordtype">integer</span> :: <a class="code" href="namespacempi__subdomain.html#a4f3d66535b947c7afee75e6e73a47206">ddtype_sendto_f</a>, <a class="code" href="namespacempi__subdomain.html#ad6462f18c8c68c076005957e9d062252">ddtype_recvfrom_b</a>, <a class="code" href="namespacempi__subdomain.html#a7a2af0322a7aaa435951a5432859687a">ddtype_sendto_b</a>, <a class="code" href="namespacempi__subdomain.html#a4da19838e8bc3934ad5c24db424bec2c">ddtype_recvfrom_f</a></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordtype">private</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keywordtype">public</span>  :: <a class="code" href="namespacempi__subdomain.html#a3a1e7cf64aafbebd3c09b92fc56bd311">mpi_subdomain_make</a></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordtype">public</span>  :: <a class="code" href="namespacempi__subdomain.html#a56e9f2afd59e45fcada0f1c21a90eefe">mpi_subdomain_clean</a></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordtype">public</span>  :: <a class="code" href="namespacempi__subdomain.html#ad788c273d92ea7058caf0874bffdad6d">mpi_subdomain_make_ghostcell_ddtype</a></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordtype">public</span>  :: <a class="code" href="namespacempi__subdomain.html#a2e34a77537009dd448375e8fdc8d5b62">mpi_subdomain_ghostcell_update</a></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordtype">public</span>  :: <a class="code" href="namespacempi__subdomain.html#afe948dc18da021f2448cf9a6265155fe">mpi_subdomain_indices</a></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordtype">public</span>  :: <a class="code" href="namespacempi__subdomain.html#a612331eead74041f174ece9a572c7427">mpi_subdomain_mesh</a></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keywordtype">public</span>  :: <a class="code" href="namespacempi__subdomain.html#a7cc0deb85b84358eb7addeea849733c4">mpi_subdomain_initialization</a></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordtype">public</span>  :: <a class="code" href="namespacempi__subdomain.html#a55659431068678c08d21847338390ea8">mpi_subdomain_boundary</a></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keyword">contains</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keyword">subroutine </span><a class="code" href="namespacempi__subdomain.html#a3a1e7cf64aafbebd3c09b92fc56bd311">mpi_subdomain_make</a>(nprocs_in_x, myrank_in_x, &amp;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                                         nprocs_in_y, myrank_in_y, &amp;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                                         nprocs_in_z, myrank_in_z)</div><div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="namespacempi__subdomain.html#a3a1e7cf64aafbebd3c09b92fc56bd311">   87</a></span>&#160;        <span class="keywordtype">implicit none</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: nprocs_in_x, myrank_in_x, nprocs_in_y, myrank_in_y, nprocs_in_z, myrank_in_z</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="comment">! Assigning grid numbers and grid indices of my subdomain.</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <span class="keyword">call </span><a class="code" href="para__range_8f90.html#ab75ab386311975aa4ff7cac06798fcd4">para_range</a>(1, <a class="code" href="namespaceglobal.html#a4ba10a6dbbcebb68e0d5e36a6c291898">nx</a>-1, nprocs_in_x, myrank_in_x, <a class="code" href="namespacempi__subdomain.html#ab8925faaa6f45326c1d11efa37e03566">ista</a>, <a class="code" href="namespacempi__subdomain.html#abbd7d35107c53bcfd2b2b52771f4aa67">iend</a>)</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <a class="code" href="namespacempi__subdomain.html#a005fe127fe0fc85b932814a820a36444">nx_sub</a> = <a class="code" href="namespacempi__subdomain.html#abbd7d35107c53bcfd2b2b52771f4aa67">iend</a> - <a class="code" href="namespacempi__subdomain.html#ab8925faaa6f45326c1d11efa37e03566">ista</a> + 2</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <span class="keyword">call </span><a class="code" href="para__range_8f90.html#ab75ab386311975aa4ff7cac06798fcd4">para_range</a>(1, <a class="code" href="namespaceglobal.html#a12dd7ca24c7675f31e6de07b1769991c">ny</a>-1, nprocs_in_y, myrank_in_y, <a class="code" href="namespacempi__subdomain.html#ac85bfba1caf77f9c3c0047fe9450fee6">jsta</a>, <a class="code" href="namespacempi__subdomain.html#a06433a0d1a081c51202a0010c21c9d36">jend</a>)</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <a class="code" href="namespacempi__subdomain.html#a665ba05d0ae9309dd28b9b513a0c87a1">ny_sub</a> = <a class="code" href="namespacempi__subdomain.html#a06433a0d1a081c51202a0010c21c9d36">jend</a> - <a class="code" href="namespacempi__subdomain.html#ac85bfba1caf77f9c3c0047fe9450fee6">jsta</a> + 2</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="keyword">call </span><a class="code" href="para__range_8f90.html#ab75ab386311975aa4ff7cac06798fcd4">para_range</a>(1, <a class="code" href="namespaceglobal.html#ab8d7436a6037d4c1b7248107a2f07d76">nz</a>-1, nprocs_in_z, myrank_in_z, <a class="code" href="namespacempi__subdomain.html#acd499eb1d07159aa9f5c878f9519b00f">ksta</a>, <a class="code" href="namespacempi__subdomain.html#af9934313b1ccbcb09f30916df3326076">kend</a>)</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <a class="code" href="namespacempi__subdomain.html#a07555cc931ac78376a4c81207662251f">nz_sub</a> = <a class="code" href="namespacempi__subdomain.html#af9934313b1ccbcb09f30916df3326076">kend</a> - <a class="code" href="namespacempi__subdomain.html#acd499eb1d07159aa9f5c878f9519b00f">ksta</a> + 2</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        </div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="comment">! Allocate subdomain variables.</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <span class="keyword">allocate</span>( <a class="code" href="namespacempi__subdomain.html#a978554e1520c79471ef3793ed1872b37">x_sub</a>(0:<a class="code" href="namespacempi__subdomain.html#a005fe127fe0fc85b932814a820a36444">nx_sub</a>), <a class="code" href="namespacempi__subdomain.html#a56af1740899dc9df6868e5e71a0884a5">dmx_sub</a>(0:<a class="code" href="namespacempi__subdomain.html#a005fe127fe0fc85b932814a820a36444">nx_sub</a>))</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <span class="keyword">allocate</span>( <a class="code" href="namespacempi__subdomain.html#a58b09abee5f1002de7b20b1b86f5c821">y_sub</a>(0:<a class="code" href="namespacempi__subdomain.html#a665ba05d0ae9309dd28b9b513a0c87a1">ny_sub</a>), <a class="code" href="namespacempi__subdomain.html#ae44efbff9669bfad03a79ab41b5e8ace">dmy_sub</a>(0:<a class="code" href="namespacempi__subdomain.html#a665ba05d0ae9309dd28b9b513a0c87a1">ny_sub</a>))</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="keyword">allocate</span>( <a class="code" href="namespacempi__subdomain.html#aab6d78e49471a9a3db5ad9df4c3d4041">z_sub</a>(0:<a class="code" href="namespacempi__subdomain.html#a07555cc931ac78376a4c81207662251f">nz_sub</a>), <a class="code" href="namespacempi__subdomain.html#afb6341d7362587d6fd0a06fe78ba4e3f">dmz_sub</a>(0:<a class="code" href="namespacempi__subdomain.html#a07555cc931ac78376a4c81207662251f">nz_sub</a>))</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        </div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="keyword">allocate</span>( <a class="code" href="namespacempi__subdomain.html#ad61f27caf5f32301a077e21363c2d73b">thetabc3_sub</a>(0:<a class="code" href="namespacempi__subdomain.html#a005fe127fe0fc85b932814a820a36444">nx_sub</a>, 0:<a class="code" href="namespacempi__subdomain.html#a07555cc931ac78376a4c81207662251f">nz_sub</a>), <a class="code" href="namespacempi__subdomain.html#ad1705bede0c0d39ad16f9f94afe32be6">thetabc4_sub</a>(0:<a class="code" href="namespacempi__subdomain.html#a005fe127fe0fc85b932814a820a36444">nx_sub</a>, 0:<a class="code" href="namespacempi__subdomain.html#a07555cc931ac78376a4c81207662251f">nz_sub</a>))</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keyword">allocate</span>(<a class="code" href="namespacempi__subdomain.html#ac22380b1c941dd6c53cabe7287d185e9">jmbc_index</a>(0:<a class="code" href="namespacempi__subdomain.html#a665ba05d0ae9309dd28b9b513a0c87a1">ny_sub</a>),<a class="code" href="namespacempi__subdomain.html#a9adbfdd11c7e9fdb968bb8eef2b13c2b">jpbc_index</a>(0:<a class="code" href="namespacempi__subdomain.html#a665ba05d0ae9309dd28b9b513a0c87a1">ny_sub</a>))</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="keyword">    end subroutine </span><a class="code" href="namespacempi__subdomain.html#a3a1e7cf64aafbebd3c09b92fc56bd311">mpi_subdomain_make</a></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keyword">subroutine </span><a class="code" href="namespacempi__subdomain.html#a56e9f2afd59e45fcada0f1c21a90eefe">mpi_subdomain_clean</a></div><div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="namespacempi__subdomain.html#a56e9f2afd59e45fcada0f1c21a90eefe">  113</a></span>&#160;        <span class="keywordtype">implicit none</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="keyword">deallocate</span>(<a class="code" href="namespacempi__subdomain.html#a978554e1520c79471ef3793ed1872b37">x_sub</a>, <a class="code" href="namespacempi__subdomain.html#a56af1740899dc9df6868e5e71a0884a5">dmx_sub</a>)</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="keyword">deallocate</span>(<a class="code" href="namespacempi__subdomain.html#a58b09abee5f1002de7b20b1b86f5c821">y_sub</a>, <a class="code" href="namespacempi__subdomain.html#ae44efbff9669bfad03a79ab41b5e8ace">dmy_sub</a>)</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <span class="keyword">deallocate</span>(<a class="code" href="namespacempi__subdomain.html#aab6d78e49471a9a3db5ad9df4c3d4041">z_sub</a>, <a class="code" href="namespacempi__subdomain.html#afb6341d7362587d6fd0a06fe78ba4e3f">dmz_sub</a>)</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="keyword">deallocate</span>(<a class="code" href="namespacempi__subdomain.html#ad61f27caf5f32301a077e21363c2d73b">thetabc3_sub</a>,<a class="code" href="namespacempi__subdomain.html#ad1705bede0c0d39ad16f9f94afe32be6">thetabc4_sub</a>)</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="keyword">deallocate</span>(<a class="code" href="namespacempi__subdomain.html#ac22380b1c941dd6c53cabe7287d185e9">jmbc_index</a>,<a class="code" href="namespacempi__subdomain.html#a9adbfdd11c7e9fdb968bb8eef2b13c2b">jpbc_index</a>)</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="keyword">    end subroutine </span><a class="code" href="namespacempi__subdomain.html#a56e9f2afd59e45fcada0f1c21a90eefe">mpi_subdomain_clean</a></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keyword">subroutine </span><a class="code" href="namespacempi__subdomain.html#ad788c273d92ea7058caf0874bffdad6d">mpi_subdomain_make_ghostcell_ddtype</a></div><div class="line"><a name="l00128"></a><span class="lineno"><a class="line" href="namespacempi__subdomain.html#ad788c273d92ea7058caf0874bffdad6d">  128</a></span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="keywordtype">implicit none</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="keywordtype">integer</span> :: sizes(0:2), subsizes(0:2), starts(0:2), <a class="code" href="namespacempi__subdomain.html#acd16f258caed20a7d8d38cd28ae64688">ierr</a>     <span class="comment">! Local variables for MPI_Type_create_subarray</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="comment">! ddtype sending data to east MPI process (x+ neighbor)</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        sizes    = (/<a class="code" href="namespacempi__subdomain.html#a005fe127fe0fc85b932814a820a36444">nx_sub</a>+1,<a class="code" href="namespacempi__subdomain.html#a665ba05d0ae9309dd28b9b513a0c87a1">ny_sub</a>+1,<a class="code" href="namespacempi__subdomain.html#a07555cc931ac78376a4c81207662251f">nz_sub</a>+1/)</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        subsizes = (/      1,<a class="code" href="namespacempi__subdomain.html#a665ba05d0ae9309dd28b9b513a0c87a1">ny_sub</a>+1,<a class="code" href="namespacempi__subdomain.html#a07555cc931ac78376a4c81207662251f">nz_sub</a>+1/)</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        starts   = (/<a class="code" href="namespacempi__subdomain.html#a005fe127fe0fc85b932814a820a36444">nx_sub</a>-1,      0,      0/)</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="keyword">call </span>mpi_type_create_subarray(3, sizes, subsizes, starts, mpi_order_fortran, &amp;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                                    mpi_double_precision, <a class="code" href="namespacempi__subdomain.html#a93395266b1630e5a91e8e89531dfcec6">ddtype_sendto_e</a>, <a class="code" href="namespacempi__subdomain.html#acd16f258caed20a7d8d38cd28ae64688">ierr</a>)</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="keyword">call </span>mpi_type_commit(<a class="code" href="namespacempi__subdomain.html#a93395266b1630e5a91e8e89531dfcec6">ddtype_sendto_e</a>,<a class="code" href="namespacempi__subdomain.html#acd16f258caed20a7d8d38cd28ae64688">ierr</a>)</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <span class="comment">! ddtype receiving data from west MPI process (x- neighbor)</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        starts   = (/      0,      0,      0/)</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="keyword">call </span>mpi_type_create_subarray(3, sizes, subsizes, starts, mpi_order_fortran, &amp;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                                    mpi_double_precision, <a class="code" href="namespacempi__subdomain.html#a0b2a4ab6d6a88a3817f473a5c2c172b9">ddtype_recvfrom_w</a>, <a class="code" href="namespacempi__subdomain.html#acd16f258caed20a7d8d38cd28ae64688">ierr</a>)</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="keyword">call </span>mpi_type_commit(<a class="code" href="namespacempi__subdomain.html#a0b2a4ab6d6a88a3817f473a5c2c172b9">ddtype_recvfrom_w</a>,<a class="code" href="namespacempi__subdomain.html#acd16f258caed20a7d8d38cd28ae64688">ierr</a>)</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="comment">! ddtype sending data to west MPI process (x- neighbor)</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        starts   = (/      1,      0,      0/)</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keyword">call </span>mpi_type_create_subarray(3, sizes, subsizes, starts, mpi_order_fortran, &amp;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                                    mpi_double_precision, <a class="code" href="namespacempi__subdomain.html#a0701fde01daea1a6fd51b62c75b8ee82">ddtype_sendto_w</a>, <a class="code" href="namespacempi__subdomain.html#acd16f258caed20a7d8d38cd28ae64688">ierr</a>)</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="keyword">call </span>mpi_type_commit(<a class="code" href="namespacempi__subdomain.html#a0701fde01daea1a6fd51b62c75b8ee82">ddtype_sendto_w</a>,<a class="code" href="namespacempi__subdomain.html#acd16f258caed20a7d8d38cd28ae64688">ierr</a>)</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="comment">! ddtype receiving data from east MPI process (x+ neighbor)</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        starts   = (/  <a class="code" href="namespacempi__subdomain.html#a005fe127fe0fc85b932814a820a36444">nx_sub</a>,      0,      0/)</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="keyword">call </span>mpi_type_create_subarray(3, sizes, subsizes, starts, mpi_order_fortran, &amp;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                                    mpi_double_precision, <a class="code" href="namespacempi__subdomain.html#a18a84c0f3ca27cd4dd73057ff035f341">ddtype_recvfrom_e</a>, <a class="code" href="namespacempi__subdomain.html#acd16f258caed20a7d8d38cd28ae64688">ierr</a>)</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <span class="keyword">call </span>mpi_type_commit(<a class="code" href="namespacempi__subdomain.html#a18a84c0f3ca27cd4dd73057ff035f341">ddtype_recvfrom_e</a>,<a class="code" href="namespacempi__subdomain.html#acd16f258caed20a7d8d38cd28ae64688">ierr</a>)</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="comment">! ddtype sending data to north MPI process (y+ neighbor)</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        sizes    = (/<a class="code" href="namespacempi__subdomain.html#a005fe127fe0fc85b932814a820a36444">nx_sub</a>+1,<a class="code" href="namespacempi__subdomain.html#a665ba05d0ae9309dd28b9b513a0c87a1">ny_sub</a>+1,<a class="code" href="namespacempi__subdomain.html#a07555cc931ac78376a4c81207662251f">nz_sub</a>+1/)</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        subsizes = (/<a class="code" href="namespacempi__subdomain.html#a005fe127fe0fc85b932814a820a36444">nx_sub</a>+1,      1,<a class="code" href="namespacempi__subdomain.html#a07555cc931ac78376a4c81207662251f">nz_sub</a>+1/)</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        starts   = (/      0,<a class="code" href="namespacempi__subdomain.html#a665ba05d0ae9309dd28b9b513a0c87a1">ny_sub</a>-1,      0/)</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="keyword">call </span>mpi_type_create_subarray(3, sizes, subsizes, starts, mpi_order_fortran, &amp;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                                    mpi_double_precision, <a class="code" href="namespacempi__subdomain.html#a55f5c1af9bd941fd176e619bddbb8d82">ddtype_sendto_n</a>, <a class="code" href="namespacempi__subdomain.html#acd16f258caed20a7d8d38cd28ae64688">ierr</a>)</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <span class="keyword">call </span>mpi_type_commit(<a class="code" href="namespacempi__subdomain.html#a55f5c1af9bd941fd176e619bddbb8d82">ddtype_sendto_n</a>,<a class="code" href="namespacempi__subdomain.html#acd16f258caed20a7d8d38cd28ae64688">ierr</a>)</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="comment">! ddtype receiving data from south MPI process (y- neighbor)</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        starts   = (/      0,      0,      0/)</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="keyword">call </span>mpi_type_create_subarray(3, sizes, subsizes, starts, mpi_order_fortran, &amp;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                                    mpi_double_precision, <a class="code" href="namespacempi__subdomain.html#a1f46916f08758533cad3ecac33233e38">ddtype_recvfrom_s</a>, <a class="code" href="namespacempi__subdomain.html#acd16f258caed20a7d8d38cd28ae64688">ierr</a>)</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <span class="keyword">call </span>mpi_type_commit(<a class="code" href="namespacempi__subdomain.html#a1f46916f08758533cad3ecac33233e38">ddtype_recvfrom_s</a>,<a class="code" href="namespacempi__subdomain.html#acd16f258caed20a7d8d38cd28ae64688">ierr</a>)</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <span class="comment">! ddtype sending data to south MPI process (y- neighbor)</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        starts   = (/      0,      1,      0/)</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keyword">call </span>mpi_type_create_subarray(3, sizes, subsizes, starts, mpi_order_fortran, &amp;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                                    mpi_double_precision, <a class="code" href="namespacempi__subdomain.html#a660f83d621188fb7eb60ad10eab4c9b5">ddtype_sendto_s</a>, <a class="code" href="namespacempi__subdomain.html#acd16f258caed20a7d8d38cd28ae64688">ierr</a>)</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="keyword">call </span>mpi_type_commit(<a class="code" href="namespacempi__subdomain.html#a660f83d621188fb7eb60ad10eab4c9b5">ddtype_sendto_s</a>,<a class="code" href="namespacempi__subdomain.html#acd16f258caed20a7d8d38cd28ae64688">ierr</a>)</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="comment">! ddtype receiving data from north MPI process (y+ neighbor)</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        starts   = (/      0,  <a class="code" href="namespacempi__subdomain.html#a665ba05d0ae9309dd28b9b513a0c87a1">ny_sub</a>,      0/)</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="keyword">call </span>mpi_type_create_subarray(3, sizes, subsizes, starts, mpi_order_fortran, &amp;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                                    mpi_double_precision, <a class="code" href="namespacempi__subdomain.html#a74f1edb3c9227692b250285680518dc4">ddtype_recvfrom_n</a>, <a class="code" href="namespacempi__subdomain.html#acd16f258caed20a7d8d38cd28ae64688">ierr</a>)</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="keyword">call </span>mpi_type_commit(<a class="code" href="namespacempi__subdomain.html#a74f1edb3c9227692b250285680518dc4">ddtype_recvfrom_n</a>,<a class="code" href="namespacempi__subdomain.html#acd16f258caed20a7d8d38cd28ae64688">ierr</a>)</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="comment">! ddtype sending data to forth MPI process (z+ neighbor)</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        sizes    = (/<a class="code" href="namespacempi__subdomain.html#a005fe127fe0fc85b932814a820a36444">nx_sub</a>+1,<a class="code" href="namespacempi__subdomain.html#a665ba05d0ae9309dd28b9b513a0c87a1">ny_sub</a>+1,<a class="code" href="namespacempi__subdomain.html#a07555cc931ac78376a4c81207662251f">nz_sub</a>+1/)</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        subsizes = (/<a class="code" href="namespacempi__subdomain.html#a005fe127fe0fc85b932814a820a36444">nx_sub</a>+1,<a class="code" href="namespacempi__subdomain.html#a665ba05d0ae9309dd28b9b513a0c87a1">ny_sub</a>+1,      1/)</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        starts   = (/      0,      0,<a class="code" href="namespacempi__subdomain.html#a07555cc931ac78376a4c81207662251f">nz_sub</a>-1/)</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="keyword">call </span>mpi_type_create_subarray(3, sizes, subsizes, starts, mpi_order_fortran, &amp;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                                    mpi_double_precision, <a class="code" href="namespacempi__subdomain.html#a4f3d66535b947c7afee75e6e73a47206">ddtype_sendto_f</a>, <a class="code" href="namespacempi__subdomain.html#acd16f258caed20a7d8d38cd28ae64688">ierr</a>)</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <span class="keyword">call </span>mpi_type_commit(<a class="code" href="namespacempi__subdomain.html#a4f3d66535b947c7afee75e6e73a47206">ddtype_sendto_f</a>,<a class="code" href="namespacempi__subdomain.html#acd16f258caed20a7d8d38cd28ae64688">ierr</a>)</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="comment">! ddtype receiving data from back MPI process (z- neighbor)</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        starts   = (/      0,      0,      0/)</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <span class="keyword">call </span>mpi_type_create_subarray(3, sizes, subsizes, starts, mpi_order_fortran, &amp;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                                    mpi_double_precision, <a class="code" href="namespacempi__subdomain.html#ad6462f18c8c68c076005957e9d062252">ddtype_recvfrom_b</a>, <a class="code" href="namespacempi__subdomain.html#acd16f258caed20a7d8d38cd28ae64688">ierr</a>)</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <span class="keyword">call </span>mpi_type_commit(<a class="code" href="namespacempi__subdomain.html#ad6462f18c8c68c076005957e9d062252">ddtype_recvfrom_b</a>,<a class="code" href="namespacempi__subdomain.html#acd16f258caed20a7d8d38cd28ae64688">ierr</a>)</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <span class="comment">! ddtype sending data to back MPI process (z- neighbor)</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        starts   = (/      0,      0,      1/)</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <span class="keyword">call </span>mpi_type_create_subarray(3, sizes, subsizes, starts, mpi_order_fortran, &amp;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                                    mpi_double_precision, <a class="code" href="namespacempi__subdomain.html#a7a2af0322a7aaa435951a5432859687a">ddtype_sendto_b</a>, <a class="code" href="namespacempi__subdomain.html#acd16f258caed20a7d8d38cd28ae64688">ierr</a>)</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="keyword">call </span>mpi_type_commit(  <a class="code" href="namespacempi__subdomain.html#a7a2af0322a7aaa435951a5432859687a">ddtype_sendto_b</a>,<a class="code" href="namespacempi__subdomain.html#acd16f258caed20a7d8d38cd28ae64688">ierr</a>)</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <span class="comment">! ddtype receiving data from forth MPI process (z+ neighbor)</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        starts   = (/      0,      0,  <a class="code" href="namespacempi__subdomain.html#a07555cc931ac78376a4c81207662251f">nz_sub</a>/)</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="keyword">call </span>mpi_type_create_subarray(3, sizes, subsizes, starts, mpi_order_fortran, &amp;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                                    mpi_double_precision, <a class="code" href="namespacempi__subdomain.html#a4da19838e8bc3934ad5c24db424bec2c">ddtype_recvfrom_f</a>, <a class="code" href="namespacempi__subdomain.html#acd16f258caed20a7d8d38cd28ae64688">ierr</a>)</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <span class="keyword">call </span>mpi_type_commit(<a class="code" href="namespacempi__subdomain.html#a4da19838e8bc3934ad5c24db424bec2c">ddtype_recvfrom_f</a>,<a class="code" href="namespacempi__subdomain.html#acd16f258caed20a7d8d38cd28ae64688">ierr</a>)</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="keyword">    end subroutine </span><a class="code" href="namespacempi__subdomain.html#ad788c273d92ea7058caf0874bffdad6d">mpi_subdomain_make_ghostcell_ddtype</a></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keyword">subroutine </span><a class="code" href="namespacempi__subdomain.html#a2e34a77537009dd448375e8fdc8d5b62">mpi_subdomain_ghostcell_update</a>(theta_sub, comm_1d_x, comm_1d_y, comm_1d_z)</div><div class="line"><a name="l00220"></a><span class="lineno"><a class="line" href="namespacempi__subdomain.html#a2e34a77537009dd448375e8fdc8d5b62">  220</a></span>&#160;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <span class="keywordtype">implicit none</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <span class="keywordtype">type</span>(<a class="code" href="structmpi__topology_1_1cart__comm__1d.html">cart_comm_1d</a>), <span class="keywordtype">intent(in)</span>  :: comm_1d_x, comm_1d_y, comm_1d_z</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <span class="keywordtype">double precision</span>, <span class="keywordtype">dimension(0:nx_sub, 0:ny_sub, 0:nz_sub)</span>, <span class="keywordtype">intent(inout)</span> :: theta_sub</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="keywordtype">integer</span> :: <a class="code" href="namespacempi__subdomain.html#acd16f258caed20a7d8d38cd28ae64688">ierr</a></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <span class="keywordtype">integer</span> :: request(12)</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <span class="comment">! Update the ghostcells in the x-direction using derived datatypes and subcommunicator.</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="keyword">call </span>mpi_isend(theta_sub,1, <a class="code" href="namespacempi__subdomain.html#a93395266b1630e5a91e8e89531dfcec6">ddtype_sendto_e</a>  , comm_1d_x%east_rank, 111, comm_1d_x%mpi_comm, request(1), <a class="code" href="namespacempi__subdomain.html#acd16f258caed20a7d8d38cd28ae64688">ierr</a>)</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="keyword">call </span>mpi_irecv(theta_sub,1, <a class="code" href="namespacempi__subdomain.html#a0b2a4ab6d6a88a3817f473a5c2c172b9">ddtype_recvfrom_w</a>, comm_1d_x%west_rank, 111, comm_1d_x%mpi_comm, request(2), <a class="code" href="namespacempi__subdomain.html#acd16f258caed20a7d8d38cd28ae64688">ierr</a>)</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <span class="keyword">call </span>mpi_isend(theta_sub,1, <a class="code" href="namespacempi__subdomain.html#a0701fde01daea1a6fd51b62c75b8ee82">ddtype_sendto_w</a>  , comm_1d_x%west_rank, 222, comm_1d_x%mpi_comm, request(3), <a class="code" href="namespacempi__subdomain.html#acd16f258caed20a7d8d38cd28ae64688">ierr</a>)</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <span class="keyword">call </span>mpi_irecv(theta_sub,1, <a class="code" href="namespacempi__subdomain.html#a18a84c0f3ca27cd4dd73057ff035f341">ddtype_recvfrom_e</a>, comm_1d_x%east_rank, 222, comm_1d_x%mpi_comm, request(4), <a class="code" href="namespacempi__subdomain.html#acd16f258caed20a7d8d38cd28ae64688">ierr</a>)</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        </div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <span class="comment">! Update the ghostcells in the y-direction using derived datatypes and subcommunicator.</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <span class="keyword">call </span>mpi_isend(theta_sub,1, <a class="code" href="namespacempi__subdomain.html#a55f5c1af9bd941fd176e619bddbb8d82">ddtype_sendto_n</a>  , comm_1d_y%east_rank, 111, comm_1d_y%mpi_comm, request(5), <a class="code" href="namespacempi__subdomain.html#acd16f258caed20a7d8d38cd28ae64688">ierr</a>)</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <span class="keyword">call </span>mpi_irecv(theta_sub,1, <a class="code" href="namespacempi__subdomain.html#a1f46916f08758533cad3ecac33233e38">ddtype_recvfrom_s</a>, comm_1d_y%west_rank, 111, comm_1d_y%mpi_comm, request(6), <a class="code" href="namespacempi__subdomain.html#acd16f258caed20a7d8d38cd28ae64688">ierr</a>)</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <span class="keyword">call </span>mpi_isend(theta_sub,1, <a class="code" href="namespacempi__subdomain.html#a660f83d621188fb7eb60ad10eab4c9b5">ddtype_sendto_s</a>  , comm_1d_y%west_rank, 222, comm_1d_y%mpi_comm, request(7), <a class="code" href="namespacempi__subdomain.html#acd16f258caed20a7d8d38cd28ae64688">ierr</a>)</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <span class="keyword">call </span>mpi_irecv(theta_sub,1, <a class="code" href="namespacempi__subdomain.html#a74f1edb3c9227692b250285680518dc4">ddtype_recvfrom_n</a>, comm_1d_y%east_rank, 222, comm_1d_y%mpi_comm, request(8), <a class="code" href="namespacempi__subdomain.html#acd16f258caed20a7d8d38cd28ae64688">ierr</a>)</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        </div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <span class="comment">! Update the ghostcells in the z-direction using derived datatypes and subcommunicator.</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="keyword">call </span>mpi_isend(theta_sub,1, <a class="code" href="namespacempi__subdomain.html#a4f3d66535b947c7afee75e6e73a47206">ddtype_sendto_f</a>  , comm_1d_z%east_rank, 111, comm_1d_z%mpi_comm, request(9) , <a class="code" href="namespacempi__subdomain.html#acd16f258caed20a7d8d38cd28ae64688">ierr</a>)</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <span class="keyword">call </span>mpi_irecv(theta_sub,1, <a class="code" href="namespacempi__subdomain.html#ad6462f18c8c68c076005957e9d062252">ddtype_recvfrom_b</a>, comm_1d_z%west_rank, 111, comm_1d_z%mpi_comm, request(10), <a class="code" href="namespacempi__subdomain.html#acd16f258caed20a7d8d38cd28ae64688">ierr</a>)</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="keyword">call </span>mpi_isend(theta_sub,1, <a class="code" href="namespacempi__subdomain.html#a7a2af0322a7aaa435951a5432859687a">ddtype_sendto_b</a>  , comm_1d_z%west_rank, 222, comm_1d_z%mpi_comm, request(11), <a class="code" href="namespacempi__subdomain.html#acd16f258caed20a7d8d38cd28ae64688">ierr</a>)</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <span class="keyword">call </span>mpi_irecv(theta_sub,1, <a class="code" href="namespacempi__subdomain.html#a4da19838e8bc3934ad5c24db424bec2c">ddtype_recvfrom_f</a>, comm_1d_z%east_rank, 222, comm_1d_z%mpi_comm, request(12), <a class="code" href="namespacempi__subdomain.html#acd16f258caed20a7d8d38cd28ae64688">ierr</a>)</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        </div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        <span class="keyword">call </span>mpi_waitall(12, request, mpi_statuses_ignore, <a class="code" href="namespacempi__subdomain.html#acd16f258caed20a7d8d38cd28ae64688">ierr</a>)</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        </div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="keyword">    end subroutine </span><a class="code" href="namespacempi__subdomain.html#a2e34a77537009dd448375e8fdc8d5b62">mpi_subdomain_ghostcell_update</a></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keyword">subroutine </span><a class="code" href="namespacempi__subdomain.html#afe948dc18da021f2448cf9a6265155fe">mpi_subdomain_indices</a>(myrank_in_y, nprocs_in_y)</div><div class="line"><a name="l00257"></a><span class="lineno"><a class="line" href="namespacempi__subdomain.html#afe948dc18da021f2448cf9a6265155fe">  257</a></span>&#160;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="keywordtype">implicit none</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: myrank_in_y, nprocs_in_y</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    </div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="comment">! All values are initialized with 1, meaning all grids are not empty and effective.</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <a class="code" href="namespacempi__subdomain.html#ac22380b1c941dd6c53cabe7287d185e9">jmbc_index</a>=1; <a class="code" href="namespacempi__subdomain.html#a9adbfdd11c7e9fdb968bb8eef2b13c2b">jpbc_index</a>=1</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    </div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <span class="comment">! Set the first jmbc_index to 0, having it empty in case of lower boundary domain.</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="keywordflow">if</span>(myrank_in_y==0) <a class="code" href="namespacempi__subdomain.html#ac22380b1c941dd6c53cabe7287d185e9">jmbc_index</a>(1)=0</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <span class="comment">! Set the last jmbc_index to 0, having it empty in case of upper boundary domain.</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <span class="keywordflow">if</span>(myrank_in_y==nprocs_in_y-1) <a class="code" href="namespacempi__subdomain.html#a9adbfdd11c7e9fdb968bb8eef2b13c2b">jpbc_index</a>(<a class="code" href="namespacempi__subdomain.html#a665ba05d0ae9309dd28b9b513a0c87a1">ny_sub</a>-1)=0</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    </div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="keywordflow">return</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="keyword">    end subroutine </span><a class="code" href="namespacempi__subdomain.html#afe948dc18da021f2448cf9a6265155fe">mpi_subdomain_indices</a></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keyword">subroutine </span><a class="code" href="namespacempi__subdomain.html#a612331eead74041f174ece9a572c7427">mpi_subdomain_mesh</a>(myrank_in_x, myrank_in_y, myrank_in_z,  &amp;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                                         nprocs_in_x, nprocs_in_y, nprocs_in_z)</div><div class="line"><a name="l00283"></a><span class="lineno"><a class="line" href="namespacempi__subdomain.html#a612331eead74041f174ece9a572c7427">  283</a></span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <span class="keywordtype">implicit none</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: myrank_in_x,myrank_in_y,myrank_in_z,nprocs_in_x,nprocs_in_y,nprocs_in_z</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    </div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="keywordtype">integer</span> :: i,j,k</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <span class="comment">! X-direction: x_sub is for coordinates and dmx_sub is for grid lengths.</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <a class="code" href="namespaceglobal.html#a9c5f8c3cf5f9b496608059fc13776b4c">dx</a> = <a class="code" href="namespaceglobal.html#ac5d2ea39fc192fbb8354e665dc91b759">lx</a>/dble(<a class="code" href="namespaceglobal.html#a4ba10a6dbbcebb68e0d5e36a6c291898">nx</a>-1)</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <span class="keywordflow">do</span> i = 0, <a class="code" href="namespacempi__subdomain.html#a005fe127fe0fc85b932814a820a36444">nx_sub</a></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            <a class="code" href="namespacempi__subdomain.html#a978554e1520c79471ef3793ed1872b37">x_sub</a>(i) = dble(i-1+<a class="code" href="namespacempi__subdomain.html#ab8925faaa6f45326c1d11efa37e03566">ista</a>-1)*<a class="code" href="namespaceglobal.html#a9c5f8c3cf5f9b496608059fc13776b4c">dx</a></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            <a class="code" href="namespacempi__subdomain.html#a56af1740899dc9df6868e5e71a0884a5">dmx_sub</a>(i)=<a class="code" href="namespaceglobal.html#a9c5f8c3cf5f9b496608059fc13776b4c">dx</a></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="keywordflow">        end do</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <span class="comment">! Y-direction: y_sub is for coordinates and dmy_sub is for grid lengths.</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <a class="code" href="namespaceglobal.html#aa2d01c0b9c06af88ae13136658fc3dd9">dy</a> = <a class="code" href="namespaceglobal.html#a6a6ee40bbab9e114aa217f7d8570b924">ly</a>/dble(<a class="code" href="namespaceglobal.html#a12dd7ca24c7675f31e6de07b1769991c">ny</a>-1)</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <span class="keywordflow">do</span> j = 0, <a class="code" href="namespacempi__subdomain.html#a665ba05d0ae9309dd28b9b513a0c87a1">ny_sub</a></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            <a class="code" href="namespacempi__subdomain.html#a58b09abee5f1002de7b20b1b86f5c821">y_sub</a>(j) = dble(j-1+<a class="code" href="namespacempi__subdomain.html#ac85bfba1caf77f9c3c0047fe9450fee6">jsta</a>-1)*<a class="code" href="namespaceglobal.html#aa2d01c0b9c06af88ae13136658fc3dd9">dy</a></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            <a class="code" href="namespacempi__subdomain.html#ae44efbff9669bfad03a79ab41b5e8ace">dmy_sub</a>(j)=<a class="code" href="namespaceglobal.html#aa2d01c0b9c06af88ae13136658fc3dd9">dy</a></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="keywordflow">        end do</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <span class="comment">! Z-direction: z_sub is for coordinates and dmz_sub is for grid lengths.</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <a class="code" href="namespaceglobal.html#a4015487c561985eefa8cabc39f591540">dz</a> = <a class="code" href="namespaceglobal.html#a9d90050855b894304d8b4272c6a9ee71">lz</a>/dble(<a class="code" href="namespaceglobal.html#ab8d7436a6037d4c1b7248107a2f07d76">nz</a>-1)</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <span class="keywordflow">do</span> k = 0, <a class="code" href="namespacempi__subdomain.html#a07555cc931ac78376a4c81207662251f">nz_sub</a></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            <a class="code" href="namespacempi__subdomain.html#aab6d78e49471a9a3db5ad9df4c3d4041">z_sub</a>(k) = dble(k-1+<a class="code" href="namespacempi__subdomain.html#acd499eb1d07159aa9f5c878f9519b00f">ksta</a>-1)*<a class="code" href="namespaceglobal.html#a4015487c561985eefa8cabc39f591540">dz</a></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            <a class="code" href="namespacempi__subdomain.html#afb6341d7362587d6fd0a06fe78ba4e3f">dmz_sub</a>(k)=<a class="code" href="namespaceglobal.html#a4015487c561985eefa8cabc39f591540">dz</a></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="keywordflow">        end do</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        <span class="comment">! For boundary grids in the x-direction. The same grid length is used due to periodic boundary conditions.</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="keywordflow">if</span>(myrank_in_x == 0) <span class="keywordflow">then</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            <a class="code" href="namespacempi__subdomain.html#a56af1740899dc9df6868e5e71a0884a5">dmx_sub</a>(0)= <a class="code" href="namespaceglobal.html#a9c5f8c3cf5f9b496608059fc13776b4c">dx</a></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(myrank_in_x == nprocs_in_x-1) <span class="keywordflow">then</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            <a class="code" href="namespacempi__subdomain.html#a56af1740899dc9df6868e5e71a0884a5">dmx_sub</a>(<a class="code" href="namespacempi__subdomain.html#a005fe127fe0fc85b932814a820a36444">nx_sub</a>)=<a class="code" href="namespaceglobal.html#a9c5f8c3cf5f9b496608059fc13776b4c">dx</a></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        <span class="comment">! For boundary grids in the y-direction. Half grid length is used for lower and upper boundary grids.</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <span class="keywordflow">if</span>(myrank_in_y == 0) <span class="keywordflow">then</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            <a class="code" href="namespacempi__subdomain.html#a58b09abee5f1002de7b20b1b86f5c821">y_sub</a>(0) = 0.0d0</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            <a class="code" href="namespacempi__subdomain.html#ae44efbff9669bfad03a79ab41b5e8ace">dmy_sub</a>(0)=0.0d0</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            <a class="code" href="namespacempi__subdomain.html#ae44efbff9669bfad03a79ab41b5e8ace">dmy_sub</a>(1)=<a class="code" href="namespaceglobal.html#aa2d01c0b9c06af88ae13136658fc3dd9">dy</a>/2.0d0</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(myrank_in_y == nprocs_in_y-1) <span class="keywordflow">then</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            <a class="code" href="namespacempi__subdomain.html#ae44efbff9669bfad03a79ab41b5e8ace">dmy_sub</a>(<a class="code" href="namespacempi__subdomain.html#a665ba05d0ae9309dd28b9b513a0c87a1">ny_sub</a>)=<a class="code" href="namespaceglobal.html#aa2d01c0b9c06af88ae13136658fc3dd9">dy</a>/2.0d0</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="keywordflow">        endif</span> </div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    </div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <span class="comment">! For boundary grids in the z-direction. The same grid length is used due to periodic boundary conditions.</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="keywordflow">if</span>(myrank_in_z == 0) <span class="keywordflow">then</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            <a class="code" href="namespacempi__subdomain.html#afb6341d7362587d6fd0a06fe78ba4e3f">dmz_sub</a>(0)=<a class="code" href="namespaceglobal.html#a4015487c561985eefa8cabc39f591540">dz</a></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(myrank_in_z == nprocs_in_z-1) <span class="keywordflow">then</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            <a class="code" href="namespacempi__subdomain.html#afb6341d7362587d6fd0a06fe78ba4e3f">dmz_sub</a>(<a class="code" href="namespacempi__subdomain.html#a07555cc931ac78376a4c81207662251f">nz_sub</a>)=<a class="code" href="namespaceglobal.html#a4015487c561985eefa8cabc39f591540">dz</a></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    </div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        <span class="keywordflow">return</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    </div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="keyword">    end subroutine </span><a class="code" href="namespacempi__subdomain.html#a612331eead74041f174ece9a572c7427">mpi_subdomain_mesh</a></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keyword">subroutine </span><a class="code" href="namespacempi__subdomain.html#a7cc0deb85b84358eb7addeea849733c4">mpi_subdomain_initialization</a>(theta_sub, myrank_in_y, nprocs_in_y)</div><div class="line"><a name="l00344"></a><span class="lineno"><a class="line" href="namespacempi__subdomain.html#a7cc0deb85b84358eb7addeea849733c4">  344</a></span>&#160;        <span class="keywordtype">implicit none</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: myrank_in_y, nprocs_in_y</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <span class="keywordtype">double precision</span>, <span class="keywordtype">intent(inout)</span> :: theta_sub(0:<a class="code" href="namespacempi__subdomain.html#a005fe127fe0fc85b932814a820a36444">nx_sub</a>, 0:<a class="code" href="namespacempi__subdomain.html#a665ba05d0ae9309dd28b9b513a0c87a1">ny_sub</a>, 0:<a class="code" href="namespacempi__subdomain.html#a07555cc931ac78376a4c81207662251f">nz_sub</a>)</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    </div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <span class="keywordtype">double precision</span>, <span class="keywordtype">parameter</span> :: <a class="code" href="namespaceglobal.html#a2eeeef6cb4401e0205ced808c718dead">pi</a> = acos(-1.d0)</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <span class="keywordtype">integer</span> :: i,j,k</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <span class="comment">! Initialize the main variable with a sine function and linearly changed values between the wall boundaries.</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        <span class="keywordflow">do</span> k = 0, <a class="code" href="namespacempi__subdomain.html#a07555cc931ac78376a4c81207662251f">nz_sub</a></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            <span class="keywordflow">do</span> j = 0, <a class="code" href="namespacempi__subdomain.html#a665ba05d0ae9309dd28b9b513a0c87a1">ny_sub</a></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                <span class="keywordflow">do</span> i = 0, <a class="code" href="namespacempi__subdomain.html#a005fe127fe0fc85b932814a820a36444">nx_sub</a></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                    theta_sub(i,j,k) = (<a class="code" href="namespaceglobal.html#a367640054e0083add94204f1a61bd61a">theta_cold</a>-<a class="code" href="namespaceglobal.html#a63b846fbcd5aedd45f92a0b1eb972244">theta_hot</a>)/<a class="code" href="namespaceglobal.html#a6a6ee40bbab9e114aa217f7d8570b924">ly</a>*<a class="code" href="namespacempi__subdomain.html#a58b09abee5f1002de7b20b1b86f5c821">y_sub</a>(j)+<a class="code" href="namespaceglobal.html#a63b846fbcd5aedd45f92a0b1eb972244">theta_hot</a>   &amp;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                                    &amp; + sin(2*2.d0*<a class="code" href="namespaceglobal.html#a2eeeef6cb4401e0205ced808c718dead">pi</a>/<a class="code" href="namespaceglobal.html#ac5d2ea39fc192fbb8354e665dc91b759">lx</a> *<a class="code" href="namespacempi__subdomain.html#a978554e1520c79471ef3793ed1872b37">x_sub</a>(i))          &amp;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                                    &amp; * sin(2*2.d0*<a class="code" href="namespaceglobal.html#a2eeeef6cb4401e0205ced808c718dead">pi</a>/<a class="code" href="namespaceglobal.html#a9d90050855b894304d8b4272c6a9ee71">lz</a> *<a class="code" href="namespacempi__subdomain.html#aab6d78e49471a9a3db5ad9df4c3d4041">z_sub</a>(k))          &amp;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                                    &amp; * sin(2*2.d0*<a class="code" href="namespaceglobal.html#a2eeeef6cb4401e0205ced808c718dead">pi</a>/<a class="code" href="namespaceglobal.html#a6a6ee40bbab9e114aa217f7d8570b924">ly</a> *<a class="code" href="namespacempi__subdomain.html#a58b09abee5f1002de7b20b1b86f5c821">y_sub</a>(j))</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="keywordflow">                end do</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="keywordflow">            end do</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="keywordflow">        end do</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    </div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <span class="comment">! Initialize the values of the upper and lower boundary grids.</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        <span class="keywordflow">do</span> k = 0, <a class="code" href="namespacempi__subdomain.html#a07555cc931ac78376a4c81207662251f">nz_sub</a></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            <span class="keywordflow">do</span> i = 0, <a class="code" href="namespacempi__subdomain.html#a005fe127fe0fc85b932814a820a36444">nx_sub</a></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                <span class="keywordflow">if</span>(myrank_in_y==0) theta_sub(i,0,k)  = <a class="code" href="namespaceglobal.html#a63b846fbcd5aedd45f92a0b1eb972244">theta_hot</a></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                <span class="keywordflow">if</span>(myrank_in_y==nprocs_in_y-1) theta_sub(i,<a class="code" href="namespacempi__subdomain.html#a665ba05d0ae9309dd28b9b513a0c87a1">ny_sub</a>,k) = <a class="code" href="namespaceglobal.html#a367640054e0083add94204f1a61bd61a">theta_cold</a></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="keywordflow">            end do</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="keywordflow">        end do</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    </div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <span class="keywordflow">return</span>    </div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="keyword">    end subroutine </span><a class="code" href="namespacempi__subdomain.html#a7cc0deb85b84358eb7addeea849733c4">mpi_subdomain_initialization</a></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    </div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="keyword">subroutine </span><a class="code" href="namespacempi__subdomain.html#a55659431068678c08d21847338390ea8">mpi_subdomain_boundary</a>(theta_sub, myrank_in_y, nprocs_in_y)</div><div class="line"><a name="l00381"></a><span class="lineno"><a class="line" href="namespacempi__subdomain.html#a55659431068678c08d21847338390ea8">  381</a></span>&#160;        <span class="keywordtype">implicit none</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: myrank_in_y, nprocs_in_y</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <span class="keywordtype">double precision</span>, <span class="keywordtype">intent(in)</span> :: theta_sub(0:<a class="code" href="namespacempi__subdomain.html#a005fe127fe0fc85b932814a820a36444">nx_sub</a>, 0:<a class="code" href="namespacempi__subdomain.html#a665ba05d0ae9309dd28b9b513a0c87a1">ny_sub</a>, 0:<a class="code" href="namespacempi__subdomain.html#a07555cc931ac78376a4c81207662251f">nz_sub</a>)</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    </div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        <span class="keywordtype">integer</span> :: i,k</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        <span class="comment">! Lower boundary subdomain: Assign lower boundary condition to the boundary variables.</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <span class="keywordflow">if</span>(myrank_in_y==0) <span class="keywordflow">then</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;            <span class="keywordflow">do</span> k = 0, <a class="code" href="namespacempi__subdomain.html#a07555cc931ac78376a4c81207662251f">nz_sub</a></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                <span class="keywordflow">do</span> i = 0, <a class="code" href="namespacempi__subdomain.html#a005fe127fe0fc85b932814a820a36444">nx_sub</a></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                    <a class="code" href="namespacempi__subdomain.html#ad61f27caf5f32301a077e21363c2d73b">thetabc3_sub</a>(i,k) = <a class="code" href="namespaceglobal.html#a63b846fbcd5aedd45f92a0b1eb972244">theta_hot</a></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                    <a class="code" href="namespacempi__subdomain.html#ad1705bede0c0d39ad16f9f94afe32be6">thetabc4_sub</a>(i,k) = theta_sub(i,<a class="code" href="namespacempi__subdomain.html#a665ba05d0ae9309dd28b9b513a0c87a1">ny_sub</a>,k)</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="keywordflow">                end do</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="keywordflow">            end do</span>  </div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        <span class="comment">! Upper boundary subdomain: Assign upper boundary condition to the boundary variables.</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(myrank_in_y==nprocs_in_y-1) <span class="keywordflow">then</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            <span class="keywordflow">do</span> k = 0, <a class="code" href="namespacempi__subdomain.html#a07555cc931ac78376a4c81207662251f">nz_sub</a></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                <span class="keywordflow">do</span> i = 0, <a class="code" href="namespacempi__subdomain.html#a005fe127fe0fc85b932814a820a36444">nx_sub</a></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                    <a class="code" href="namespacempi__subdomain.html#ad61f27caf5f32301a077e21363c2d73b">thetabc3_sub</a>(i,k) = theta_sub(i,0,k)</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                    <a class="code" href="namespacempi__subdomain.html#ad1705bede0c0d39ad16f9f94afe32be6">thetabc4_sub</a>(i,k) = <a class="code" href="namespaceglobal.html#a367640054e0083add94204f1a61bd61a">theta_cold</a></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="keywordflow">                end do</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="keywordflow">            end do</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        <span class="comment">! Normal subdomain: Assign values of ghostcells to the boundary variables.</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            <span class="keywordflow">do</span> k = 0, <a class="code" href="namespacempi__subdomain.html#a07555cc931ac78376a4c81207662251f">nz_sub</a></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                <span class="keywordflow">do</span> i = 0, <a class="code" href="namespacempi__subdomain.html#a005fe127fe0fc85b932814a820a36444">nx_sub</a></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                    <a class="code" href="namespacempi__subdomain.html#ad61f27caf5f32301a077e21363c2d73b">thetabc3_sub</a>(i,k) = theta_sub(i,    0,k)</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                    <a class="code" href="namespacempi__subdomain.html#ad1705bede0c0d39ad16f9f94afe32be6">thetabc4_sub</a>(i,k) = theta_sub(i,<a class="code" href="namespacempi__subdomain.html#a665ba05d0ae9309dd28b9b513a0c87a1">ny_sub</a>,k)</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="keywordflow">                end do</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="keywordflow">            end do</span>  </div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    </div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        <span class="keywordflow">return</span>    </div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="keyword">    end subroutine </span><a class="code" href="namespacempi__subdomain.html#a55659431068678c08d21847338390ea8">mpi_subdomain_boundary</a></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    </div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="keyword">end module </span><a class="code" href="namespacempi__subdomain.html">mpi_subdomain</a></div><div class="ttc" id="namespacempi__subdomain_html_ad61f27caf5f32301a077e21363c2d73b"><div class="ttname"><a href="namespacempi__subdomain.html#ad61f27caf5f32301a077e21363c2d73b">mpi_subdomain::thetabc3_sub</a></div><div class="ttdeci">double precision, dimension(:,:), allocatable, public thetabc3_sub</div><div class="ttdoc">B.C. of lower wall.</div><div class="ttdef"><b>Definition:</b> <a href="mpi__subdomain_8f90_source.html#l00047">mpi_subdomain.f90:47</a></div></div>
<div class="ttc" id="namespacempi__subdomain_html_a1f46916f08758533cad3ecac33233e38"><div class="ttname"><a href="namespacempi__subdomain.html#a1f46916f08758533cad3ecac33233e38">mpi_subdomain::ddtype_recvfrom_s</a></div><div class="ttdeci">integer ddtype_recvfrom_s</div><div class="ttdoc">Derived datatype for communication between y-neighbor subdomains.</div><div class="ttdef"><b>Definition:</b> <a href="mpi__subdomain_8f90_source.html#l00057">mpi_subdomain.f90:57</a></div></div>
<div class="ttc" id="namespacempi__subdomain_html"><div class="ttname"><a href="namespacempi__subdomain.html">mpi_subdomain</a></div><div class="ttdoc">Module for building subdomains from the physical domain.</div><div class="ttdef"><b>Definition:</b> <a href="mpi__subdomain_8f90_source.html#l00025">mpi_subdomain.f90:25</a></div></div>
<div class="ttc" id="namespaceglobal_html_a63b846fbcd5aedd45f92a0b1eb972244"><div class="ttname"><a href="namespaceglobal.html#a63b846fbcd5aedd45f92a0b1eb972244">global::theta_hot</a></div><div class="ttdeci">double precision theta_hot</div><div class="ttdoc">Boundary temperature of hot wall.</div><div class="ttdef"><b>Definition:</b> <a href="global_8f90_source.html#l00060">global.f90:60</a></div></div>
<div class="ttc" id="namespaceglobal_html_a6a6ee40bbab9e114aa217f7d8570b924"><div class="ttname"><a href="namespaceglobal.html#a6a6ee40bbab9e114aa217f7d8570b924">global::ly</a></div><div class="ttdeci">double precision ly</div><div class="ttdoc">Lengths of the physical domain.</div><div class="ttdef"><b>Definition:</b> <a href="global_8f90_source.html#l00052">global.f90:52</a></div></div>
<div class="ttc" id="namespacempi__subdomain_html_a3a1e7cf64aafbebd3c09b92fc56bd311"><div class="ttname"><a href="namespacempi__subdomain.html#a3a1e7cf64aafbebd3c09b92fc56bd311">mpi_subdomain::mpi_subdomain_make</a></div><div class="ttdeci">subroutine, public mpi_subdomain_make(nprocs_in_x, myrank_in_x, nprocs_in_y, myrank_in_y, nprocs_in_z, myrank_in_z)</div><div class="ttdoc">Prepare the subdomain and determine the size of the subdomain.</div><div class="ttdef"><b>Definition:</b> <a href="mpi__subdomain_8f90_source.html#l00087">mpi_subdomain.f90:87</a></div></div>
<div class="ttc" id="namespacempi__subdomain_html_acd16f258caed20a7d8d38cd28ae64688"><div class="ttname"><a href="namespacempi__subdomain.html#acd16f258caed20a7d8d38cd28ae64688">mpi_subdomain::ierr</a></div><div class="ttdeci">integer ierr</div><div class="ttdef"><b>Definition:</b> <a href="mpi__subdomain_8f90_source.html#l00033">mpi_subdomain.f90:33</a></div></div>
<div class="ttc" id="namespacempi__subdomain_html_a978554e1520c79471ef3793ed1872b37"><div class="ttname"><a href="namespacempi__subdomain.html#a978554e1520c79471ef3793ed1872b37">mpi_subdomain::x_sub</a></div><div class="ttdeci">double precision, dimension(:), allocatable, public x_sub</div><div class="ttdoc">Coordinates of grid points in the subdomain.</div><div class="ttdef"><b>Definition:</b> <a href="mpi__subdomain_8f90_source.html#l00042">mpi_subdomain.f90:42</a></div></div>
<div class="ttc" id="namespacempi__subdomain_html_a74f1edb3c9227692b250285680518dc4"><div class="ttname"><a href="namespacempi__subdomain.html#a74f1edb3c9227692b250285680518dc4">mpi_subdomain::ddtype_recvfrom_n</a></div><div class="ttdeci">integer ddtype_recvfrom_n</div><div class="ttdoc">Derived datatype for communication between y-neighbor subdomains.</div><div class="ttdef"><b>Definition:</b> <a href="mpi__subdomain_8f90_source.html#l00057">mpi_subdomain.f90:57</a></div></div>
<div class="ttc" id="namespacempi__subdomain_html_aab6d78e49471a9a3db5ad9df4c3d4041"><div class="ttname"><a href="namespacempi__subdomain.html#aab6d78e49471a9a3db5ad9df4c3d4041">mpi_subdomain::z_sub</a></div><div class="ttdeci">double precision, dimension(:), allocatable, public z_sub</div><div class="ttdoc">Coordinates of grid points in the subdomain.</div><div class="ttdef"><b>Definition:</b> <a href="mpi__subdomain_8f90_source.html#l00042">mpi_subdomain.f90:42</a></div></div>
<div class="ttc" id="namespacempi__subdomain_html_a4f3d66535b947c7afee75e6e73a47206"><div class="ttname"><a href="namespacempi__subdomain.html#a4f3d66535b947c7afee75e6e73a47206">mpi_subdomain::ddtype_sendto_f</a></div><div class="ttdeci">integer ddtype_sendto_f</div><div class="ttdoc">Derived datatype for communication between z-neighbor subdomains.</div><div class="ttdef"><b>Definition:</b> <a href="mpi__subdomain_8f90_source.html#l00060">mpi_subdomain.f90:60</a></div></div>
<div class="ttc" id="para__range_8f90_html_ab75ab386311975aa4ff7cac06798fcd4"><div class="ttname"><a href="para__range_8f90.html#ab75ab386311975aa4ff7cac06798fcd4">para_range</a></div><div class="ttdeci">subroutine para_range(n1, n2, nprocs, myrank, ista, iend)</div><div class="ttdoc">Compute the indices of the assigned range for each MPI process .</div><div class="ttdef"><b>Definition:</b> <a href="para__range_8f90_source.html#l00027">para_range.f90:27</a></div></div>
<div class="ttc" id="namespacempi__subdomain_html_a660f83d621188fb7eb60ad10eab4c9b5"><div class="ttname"><a href="namespacempi__subdomain.html#a660f83d621188fb7eb60ad10eab4c9b5">mpi_subdomain::ddtype_sendto_s</a></div><div class="ttdeci">integer ddtype_sendto_s</div><div class="ttdoc">Derived datatype for communication between y-neighbor subdomains.</div><div class="ttdef"><b>Definition:</b> <a href="mpi__subdomain_8f90_source.html#l00057">mpi_subdomain.f90:57</a></div></div>
<div class="ttc" id="namespaceglobal_html_ac5d2ea39fc192fbb8354e665dc91b759"><div class="ttname"><a href="namespaceglobal.html#ac5d2ea39fc192fbb8354e665dc91b759">global::lx</a></div><div class="ttdeci">double precision lx</div><div class="ttdoc">Lengths of the physical domain.</div><div class="ttdef"><b>Definition:</b> <a href="global_8f90_source.html#l00052">global.f90:52</a></div></div>
<div class="ttc" id="namespacempi__subdomain_html_a665ba05d0ae9309dd28b9b513a0c87a1"><div class="ttname"><a href="namespacempi__subdomain.html#a665ba05d0ae9309dd28b9b513a0c87a1">mpi_subdomain::ny_sub</a></div><div class="ttdeci">integer, public ny_sub</div><div class="ttdoc">Grid numbers in the subdomain.</div><div class="ttdef"><b>Definition:</b> <a href="mpi__subdomain_8f90_source.html#l00035">mpi_subdomain.f90:35</a></div></div>
<div class="ttc" id="namespaceglobal_html_ab8d7436a6037d4c1b7248107a2f07d76"><div class="ttname"><a href="namespaceglobal.html#ab8d7436a6037d4c1b7248107a2f07d76">global::nz</a></div><div class="ttdeci">integer nz</div><div class="ttdoc">Grid numbers in each direction.</div><div class="ttdef"><b>Definition:</b> <a href="global_8f90_source.html#l00038">global.f90:38</a></div></div>
<div class="ttc" id="namespaceglobal_html"><div class="ttname"><a href="namespaceglobal.html">global</a></div><div class="ttdoc">Module for global parameters.</div><div class="ttdef"><b>Definition:</b> <a href="global_8f90_source.html#l00025">global.f90:25</a></div></div>
<div class="ttc" id="namespacempi__subdomain_html_abbd7d35107c53bcfd2b2b52771f4aa67"><div class="ttname"><a href="namespacempi__subdomain.html#abbd7d35107c53bcfd2b2b52771f4aa67">mpi_subdomain::iend</a></div><div class="ttdeci">integer, public iend</div><div class="ttdoc">Grid indices of the assigned range.</div><div class="ttdef"><b>Definition:</b> <a href="mpi__subdomain_8f90_source.html#l00038">mpi_subdomain.f90:38</a></div></div>
<div class="ttc" id="namespaceglobal_html_a367640054e0083add94204f1a61bd61a"><div class="ttname"><a href="namespaceglobal.html#a367640054e0083add94204f1a61bd61a">global::theta_cold</a></div><div class="ttdeci">double precision theta_cold</div><div class="ttdoc">Boundary temperature of cold wall.</div><div class="ttdef"><b>Definition:</b> <a href="global_8f90_source.html#l00059">global.f90:59</a></div></div>
<div class="ttc" id="namespacempi__subdomain_html_a2e34a77537009dd448375e8fdc8d5b62"><div class="ttname"><a href="namespacempi__subdomain.html#a2e34a77537009dd448375e8fdc8d5b62">mpi_subdomain::mpi_subdomain_ghostcell_update</a></div><div class="ttdeci">subroutine, public mpi_subdomain_ghostcell_update(theta_sub, comm_1d_x, comm_1d_y, comm_1d_z)</div><div class="ttdoc">Update the values of boundary ghostcells through communication in all directions.</div><div class="ttdef"><b>Definition:</b> <a href="mpi__subdomain_8f90_source.html#l00220">mpi_subdomain.f90:220</a></div></div>
<div class="ttc" id="namespacempi__subdomain_html_a7cc0deb85b84358eb7addeea849733c4"><div class="ttname"><a href="namespacempi__subdomain.html#a7cc0deb85b84358eb7addeea849733c4">mpi_subdomain::mpi_subdomain_initialization</a></div><div class="ttdeci">subroutine, public mpi_subdomain_initialization(theta_sub, myrank_in_y, nprocs_in_y)</div><div class="ttdoc">Initialize the values of the main variable in a subdomain.</div><div class="ttdef"><b>Definition:</b> <a href="mpi__subdomain_8f90_source.html#l00344">mpi_subdomain.f90:344</a></div></div>
<div class="ttc" id="namespacempi__subdomain_html_ad788c273d92ea7058caf0874bffdad6d"><div class="ttname"><a href="namespacempi__subdomain.html#ad788c273d92ea7058caf0874bffdad6d">mpi_subdomain::mpi_subdomain_make_ghostcell_ddtype</a></div><div class="ttdeci">subroutine, public mpi_subdomain_make_ghostcell_ddtype</div><div class="ttdoc">Build derived datatypes for subdomain communication using ghostcells.</div><div class="ttdef"><b>Definition:</b> <a href="mpi__subdomain_8f90_source.html#l00128">mpi_subdomain.f90:128</a></div></div>
<div class="ttc" id="namespaceglobal_html_a4015487c561985eefa8cabc39f591540"><div class="ttname"><a href="namespaceglobal.html#a4015487c561985eefa8cabc39f591540">global::dz</a></div><div class="ttdeci">double precision dz</div><div class="ttdoc">Discretized grid lengths of the physical domain.</div><div class="ttdef"><b>Definition:</b> <a href="global_8f90_source.html#l00055">global.f90:55</a></div></div>
<div class="ttc" id="namespacempi__subdomain_html_a56e9f2afd59e45fcada0f1c21a90eefe"><div class="ttname"><a href="namespacempi__subdomain.html#a56e9f2afd59e45fcada0f1c21a90eefe">mpi_subdomain::mpi_subdomain_clean</a></div><div class="ttdeci">subroutine, public mpi_subdomain_clean</div><div class="ttdoc">Deallocate subdomain variables.</div><div class="ttdef"><b>Definition:</b> <a href="mpi__subdomain_8f90_source.html#l00113">mpi_subdomain.f90:113</a></div></div>
<div class="ttc" id="namespacempi__subdomain_html_ae44efbff9669bfad03a79ab41b5e8ace"><div class="ttname"><a href="namespacempi__subdomain.html#ae44efbff9669bfad03a79ab41b5e8ace">mpi_subdomain::dmy_sub</a></div><div class="ttdeci">double precision, dimension(:), allocatable, public dmy_sub</div><div class="ttdoc">Grid lengths in the subdomain.</div><div class="ttdef"><b>Definition:</b> <a href="mpi__subdomain_8f90_source.html#l00045">mpi_subdomain.f90:45</a></div></div>
<div class="ttc" id="namespacempi__subdomain_html_a56af1740899dc9df6868e5e71a0884a5"><div class="ttname"><a href="namespacempi__subdomain.html#a56af1740899dc9df6868e5e71a0884a5">mpi_subdomain::dmx_sub</a></div><div class="ttdeci">double precision, dimension(:), allocatable, public dmx_sub</div><div class="ttdoc">Grid lengths in the subdomain.</div><div class="ttdef"><b>Definition:</b> <a href="mpi__subdomain_8f90_source.html#l00045">mpi_subdomain.f90:45</a></div></div>
<div class="ttc" id="namespacempi__subdomain_html_a93395266b1630e5a91e8e89531dfcec6"><div class="ttname"><a href="namespacempi__subdomain.html#a93395266b1630e5a91e8e89531dfcec6">mpi_subdomain::ddtype_sendto_e</a></div><div class="ttdeci">integer ddtype_sendto_e</div><div class="ttdoc">Derived datatype for communication between x-neighbor subdomains.</div><div class="ttdef"><b>Definition:</b> <a href="mpi__subdomain_8f90_source.html#l00054">mpi_subdomain.f90:54</a></div></div>
<div class="ttc" id="namespacempi__subdomain_html_a005fe127fe0fc85b932814a820a36444"><div class="ttname"><a href="namespacempi__subdomain.html#a005fe127fe0fc85b932814a820a36444">mpi_subdomain::nx_sub</a></div><div class="ttdeci">integer, public nx_sub</div><div class="ttdoc">Grid numbers in the subdomain.</div><div class="ttdef"><b>Definition:</b> <a href="mpi__subdomain_8f90_source.html#l00035">mpi_subdomain.f90:35</a></div></div>
<div class="ttc" id="namespacempi__subdomain_html_ad6462f18c8c68c076005957e9d062252"><div class="ttname"><a href="namespacempi__subdomain.html#ad6462f18c8c68c076005957e9d062252">mpi_subdomain::ddtype_recvfrom_b</a></div><div class="ttdeci">integer ddtype_recvfrom_b</div><div class="ttdoc">Derived datatype for communication between z-neighbor subdomains.</div><div class="ttdef"><b>Definition:</b> <a href="mpi__subdomain_8f90_source.html#l00060">mpi_subdomain.f90:60</a></div></div>
<div class="ttc" id="namespacempi__subdomain_html_af9934313b1ccbcb09f30916df3326076"><div class="ttname"><a href="namespacempi__subdomain.html#af9934313b1ccbcb09f30916df3326076">mpi_subdomain::kend</a></div><div class="ttdeci">integer, public kend</div><div class="ttdoc">Grid indices of the assigned range.</div><div class="ttdef"><b>Definition:</b> <a href="mpi__subdomain_8f90_source.html#l00038">mpi_subdomain.f90:38</a></div></div>
<div class="ttc" id="namespacempi__subdomain_html_ab8925faaa6f45326c1d11efa37e03566"><div class="ttname"><a href="namespacempi__subdomain.html#ab8925faaa6f45326c1d11efa37e03566">mpi_subdomain::ista</a></div><div class="ttdeci">integer, public ista</div><div class="ttdoc">Grid indices of the assigned range.</div><div class="ttdef"><b>Definition:</b> <a href="mpi__subdomain_8f90_source.html#l00038">mpi_subdomain.f90:38</a></div></div>
<div class="ttc" id="namespacempi__subdomain_html_a55659431068678c08d21847338390ea8"><div class="ttname"><a href="namespacempi__subdomain.html#a55659431068678c08d21847338390ea8">mpi_subdomain::mpi_subdomain_boundary</a></div><div class="ttdeci">subroutine, public mpi_subdomain_boundary(theta_sub, myrank_in_y, nprocs_in_y)</div><div class="ttdoc">Assign the values of boundary grids in the subdomain.</div><div class="ttdef"><b>Definition:</b> <a href="mpi__subdomain_8f90_source.html#l00381">mpi_subdomain.f90:381</a></div></div>
<div class="ttc" id="namespaceglobal_html_a2eeeef6cb4401e0205ced808c718dead"><div class="ttname"><a href="namespaceglobal.html#a2eeeef6cb4401e0205ced808c718dead">global::pi</a></div><div class="ttdeci">double precision, parameter pi</div><div class="ttdef"><b>Definition:</b> <a href="global_8f90_source.html#l00027">global.f90:27</a></div></div>
<div class="ttc" id="namespacempi__subdomain_html_ad1705bede0c0d39ad16f9f94afe32be6"><div class="ttname"><a href="namespacempi__subdomain.html#ad1705bede0c0d39ad16f9f94afe32be6">mpi_subdomain::thetabc4_sub</a></div><div class="ttdeci">double precision, dimension(:,:), allocatable, public thetabc4_sub</div><div class="ttdoc">B.C. of upper wall.</div><div class="ttdef"><b>Definition:</b> <a href="mpi__subdomain_8f90_source.html#l00048">mpi_subdomain.f90:48</a></div></div>
<div class="ttc" id="namespaceglobal_html_a9c5f8c3cf5f9b496608059fc13776b4c"><div class="ttname"><a href="namespaceglobal.html#a9c5f8c3cf5f9b496608059fc13776b4c">global::dx</a></div><div class="ttdeci">double precision dx</div><div class="ttdoc">Discretized grid lengths of the physical domain.</div><div class="ttdef"><b>Definition:</b> <a href="global_8f90_source.html#l00055">global.f90:55</a></div></div>
<div class="ttc" id="namespacempi__subdomain_html_a7a2af0322a7aaa435951a5432859687a"><div class="ttname"><a href="namespacempi__subdomain.html#a7a2af0322a7aaa435951a5432859687a">mpi_subdomain::ddtype_sendto_b</a></div><div class="ttdeci">integer ddtype_sendto_b</div><div class="ttdoc">Derived datatype for communication between z-neighbor subdomains.</div><div class="ttdef"><b>Definition:</b> <a href="mpi__subdomain_8f90_source.html#l00060">mpi_subdomain.f90:60</a></div></div>
<div class="ttc" id="namespacempi__subdomain_html_a0b2a4ab6d6a88a3817f473a5c2c172b9"><div class="ttname"><a href="namespacempi__subdomain.html#a0b2a4ab6d6a88a3817f473a5c2c172b9">mpi_subdomain::ddtype_recvfrom_w</a></div><div class="ttdeci">integer ddtype_recvfrom_w</div><div class="ttdoc">Derived datatype for communication between x-neighbor subdomains.</div><div class="ttdef"><b>Definition:</b> <a href="mpi__subdomain_8f90_source.html#l00054">mpi_subdomain.f90:54</a></div></div>
<div class="ttc" id="namespacempi__subdomain_html_ac22380b1c941dd6c53cabe7287d185e9"><div class="ttname"><a href="namespacempi__subdomain.html#ac22380b1c941dd6c53cabe7287d185e9">mpi_subdomain::jmbc_index</a></div><div class="ttdeci">integer, dimension(:), allocatable, public jmbc_index</div><div class="ttdoc">Flag whether lower grid is empty(0) or not.</div><div class="ttdef"><b>Definition:</b> <a href="mpi__subdomain_8f90_source.html#l00050">mpi_subdomain.f90:50</a></div></div>
<div class="ttc" id="namespacempi__subdomain_html_acd499eb1d07159aa9f5c878f9519b00f"><div class="ttname"><a href="namespacempi__subdomain.html#acd499eb1d07159aa9f5c878f9519b00f">mpi_subdomain::ksta</a></div><div class="ttdeci">integer, public ksta</div><div class="ttdoc">Grid indices of the assigned range.</div><div class="ttdef"><b>Definition:</b> <a href="mpi__subdomain_8f90_source.html#l00038">mpi_subdomain.f90:38</a></div></div>
<div class="ttc" id="namespacempi__subdomain_html_a55f5c1af9bd941fd176e619bddbb8d82"><div class="ttname"><a href="namespacempi__subdomain.html#a55f5c1af9bd941fd176e619bddbb8d82">mpi_subdomain::ddtype_sendto_n</a></div><div class="ttdeci">integer ddtype_sendto_n</div><div class="ttdoc">Derived datatype for communication between y-neighbor subdomains.</div><div class="ttdef"><b>Definition:</b> <a href="mpi__subdomain_8f90_source.html#l00057">mpi_subdomain.f90:57</a></div></div>
<div class="ttc" id="namespaceglobal_html_a9d90050855b894304d8b4272c6a9ee71"><div class="ttname"><a href="namespaceglobal.html#a9d90050855b894304d8b4272c6a9ee71">global::lz</a></div><div class="ttdeci">double precision lz</div><div class="ttdoc">Lengths of the physical domain.</div><div class="ttdef"><b>Definition:</b> <a href="global_8f90_source.html#l00052">global.f90:52</a></div></div>
<div class="ttc" id="namespacempi__subdomain_html_a58b09abee5f1002de7b20b1b86f5c821"><div class="ttname"><a href="namespacempi__subdomain.html#a58b09abee5f1002de7b20b1b86f5c821">mpi_subdomain::y_sub</a></div><div class="ttdeci">double precision, dimension(:), allocatable, public y_sub</div><div class="ttdoc">Coordinates of grid points in the subdomain.</div><div class="ttdef"><b>Definition:</b> <a href="mpi__subdomain_8f90_source.html#l00042">mpi_subdomain.f90:42</a></div></div>
<div class="ttc" id="namespacempi__subdomain_html_a07555cc931ac78376a4c81207662251f"><div class="ttname"><a href="namespacempi__subdomain.html#a07555cc931ac78376a4c81207662251f">mpi_subdomain::nz_sub</a></div><div class="ttdeci">integer, public nz_sub</div><div class="ttdoc">Grid numbers in the subdomain.</div><div class="ttdef"><b>Definition:</b> <a href="mpi__subdomain_8f90_source.html#l00035">mpi_subdomain.f90:35</a></div></div>
<div class="ttc" id="namespacempi__subdomain_html_a4da19838e8bc3934ad5c24db424bec2c"><div class="ttname"><a href="namespacempi__subdomain.html#a4da19838e8bc3934ad5c24db424bec2c">mpi_subdomain::ddtype_recvfrom_f</a></div><div class="ttdeci">integer ddtype_recvfrom_f</div><div class="ttdoc">Derived datatype for communication between z-neighbor subdomains.</div><div class="ttdef"><b>Definition:</b> <a href="mpi__subdomain_8f90_source.html#l00060">mpi_subdomain.f90:60</a></div></div>
<div class="ttc" id="namespaceglobal_html_a12dd7ca24c7675f31e6de07b1769991c"><div class="ttname"><a href="namespaceglobal.html#a12dd7ca24c7675f31e6de07b1769991c">global::ny</a></div><div class="ttdeci">integer ny</div><div class="ttdoc">Grid numbers in each direction.</div><div class="ttdef"><b>Definition:</b> <a href="global_8f90_source.html#l00038">global.f90:38</a></div></div>
<div class="ttc" id="structmpi__topology_1_1cart__comm__1d_html"><div class="ttname"><a href="structmpi__topology_1_1cart__comm__1d.html">mpi_topology::cart_comm_1d</a></div><div class="ttdoc">Type variable for the information of 1D communicator.</div><div class="ttdef"><b>Definition:</b> <a href="mpi__topology_8f90_source.html#l00034">mpi_topology.f90:34</a></div></div>
<div class="ttc" id="namespaceglobal_html_aa2d01c0b9c06af88ae13136658fc3dd9"><div class="ttname"><a href="namespaceglobal.html#aa2d01c0b9c06af88ae13136658fc3dd9">global::dy</a></div><div class="ttdeci">double precision dy</div><div class="ttdoc">Discretized grid lengths of the physical domain.</div><div class="ttdef"><b>Definition:</b> <a href="global_8f90_source.html#l00055">global.f90:55</a></div></div>
<div class="ttc" id="namespacempi__subdomain_html_a06433a0d1a081c51202a0010c21c9d36"><div class="ttname"><a href="namespacempi__subdomain.html#a06433a0d1a081c51202a0010c21c9d36">mpi_subdomain::jend</a></div><div class="ttdeci">integer, public jend</div><div class="ttdoc">Grid indices of the assigned range.</div><div class="ttdef"><b>Definition:</b> <a href="mpi__subdomain_8f90_source.html#l00038">mpi_subdomain.f90:38</a></div></div>
<div class="ttc" id="namespacempi__subdomain_html_afe948dc18da021f2448cf9a6265155fe"><div class="ttname"><a href="namespacempi__subdomain.html#afe948dc18da021f2448cf9a6265155fe">mpi_subdomain::mpi_subdomain_indices</a></div><div class="ttdeci">subroutine, public mpi_subdomain_indices(myrank_in_y, nprocs_in_y)</div><div class="ttdoc">Determine whether the next grids are empty(0) or not(1) only in the y-direction.</div><div class="ttdef"><b>Definition:</b> <a href="mpi__subdomain_8f90_source.html#l00257">mpi_subdomain.f90:257</a></div></div>
<div class="ttc" id="namespacempi__subdomain_html_ac85bfba1caf77f9c3c0047fe9450fee6"><div class="ttname"><a href="namespacempi__subdomain.html#ac85bfba1caf77f9c3c0047fe9450fee6">mpi_subdomain::jsta</a></div><div class="ttdeci">integer, public jsta</div><div class="ttdoc">Grid indices of the assigned range.</div><div class="ttdef"><b>Definition:</b> <a href="mpi__subdomain_8f90_source.html#l00038">mpi_subdomain.f90:38</a></div></div>
<div class="ttc" id="namespacempi__subdomain_html_afb6341d7362587d6fd0a06fe78ba4e3f"><div class="ttname"><a href="namespacempi__subdomain.html#afb6341d7362587d6fd0a06fe78ba4e3f">mpi_subdomain::dmz_sub</a></div><div class="ttdeci">double precision, dimension(:), allocatable, public dmz_sub</div><div class="ttdoc">Grid lengths in the subdomain.</div><div class="ttdef"><b>Definition:</b> <a href="mpi__subdomain_8f90_source.html#l00045">mpi_subdomain.f90:45</a></div></div>
<div class="ttc" id="namespaceglobal_html_a4ba10a6dbbcebb68e0d5e36a6c291898"><div class="ttname"><a href="namespaceglobal.html#a4ba10a6dbbcebb68e0d5e36a6c291898">global::nx</a></div><div class="ttdeci">integer nx</div><div class="ttdoc">Grid numbers in each direction.</div><div class="ttdef"><b>Definition:</b> <a href="global_8f90_source.html#l00038">global.f90:38</a></div></div>
<div class="ttc" id="namespacempi__subdomain_html_a18a84c0f3ca27cd4dd73057ff035f341"><div class="ttname"><a href="namespacempi__subdomain.html#a18a84c0f3ca27cd4dd73057ff035f341">mpi_subdomain::ddtype_recvfrom_e</a></div><div class="ttdeci">integer ddtype_recvfrom_e</div><div class="ttdoc">Derived datatype for communication between x-neighbor subdomains.</div><div class="ttdef"><b>Definition:</b> <a href="mpi__subdomain_8f90_source.html#l00054">mpi_subdomain.f90:54</a></div></div>
<div class="ttc" id="namespacempi__topology_html"><div class="ttname"><a href="namespacempi__topology.html">mpi_topology</a></div><div class="ttdoc">Module for creating the cartesian topology of the MPI processes and subcommunicators.</div><div class="ttdef"><b>Definition:</b> <a href="mpi__topology_8f90_source.html#l00025">mpi_topology.f90:25</a></div></div>
<div class="ttc" id="namespacempi__subdomain_html_a0701fde01daea1a6fd51b62c75b8ee82"><div class="ttname"><a href="namespacempi__subdomain.html#a0701fde01daea1a6fd51b62c75b8ee82">mpi_subdomain::ddtype_sendto_w</a></div><div class="ttdeci">integer ddtype_sendto_w</div><div class="ttdoc">Derived datatype for communication between x-neighbor subdomains.</div><div class="ttdef"><b>Definition:</b> <a href="mpi__subdomain_8f90_source.html#l00054">mpi_subdomain.f90:54</a></div></div>
<div class="ttc" id="namespacempi__subdomain_html_a612331eead74041f174ece9a572c7427"><div class="ttname"><a href="namespacempi__subdomain.html#a612331eead74041f174ece9a572c7427">mpi_subdomain::mpi_subdomain_mesh</a></div><div class="ttdeci">subroutine, public mpi_subdomain_mesh(myrank_in_x, myrank_in_y, myrank_in_z, nprocs_in_x, nprocs_in_y, nprocs_in_z)</div><div class="ttdoc">Assign grid coordinates and lengths of subdomains.</div><div class="ttdef"><b>Definition:</b> <a href="mpi__subdomain_8f90_source.html#l00283">mpi_subdomain.f90:283</a></div></div>
<div class="ttc" id="namespacempi__subdomain_html_a9adbfdd11c7e9fdb968bb8eef2b13c2b"><div class="ttname"><a href="namespacempi__subdomain.html#a9adbfdd11c7e9fdb968bb8eef2b13c2b">mpi_subdomain::jpbc_index</a></div><div class="ttdeci">integer, dimension(:), allocatable, public jpbc_index</div><div class="ttdoc">Flag whether upper grid is empty(0) or not.</div><div class="ttdef"><b>Definition:</b> <a href="mpi__subdomain_8f90_source.html#l00051">mpi_subdomain.f90:51</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
