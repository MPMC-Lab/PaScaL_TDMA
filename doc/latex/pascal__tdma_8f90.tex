\hypertarget{pascal__tdma_8f90}{}\section{/\+Users/jihoon/\+Documents/develop/\+S\+T\+D\+M\+A/src/pascal\+\_\+tdma.f90 File Reference}
\label{pascal__tdma_8f90}\index{/Users/jihoon/Documents/develop/STDMA/src/pascal\_tdma.f90@{/Users/jihoon/Documents/develop/STDMA/src/pascal\_tdma.f90}}


Pa\+Sca\+L\+\_\+\+T\+D\+MA -\/ Parallel and Scalable Library for Tri-\/\+Diagonal Matrix Algorithm Pa\+Scal\+\_\+\+T\+D\+MA solves many tridiagonal systems of equations in a parallel manner using a noble all-\/to-\/all communication scheme with the modified Thomas algorithm by Laszlo et al(2016).  


\subsection*{Data Types}
\begin{DoxyCompactItemize}
\item 
type \mbox{\hyperlink{structpascal__tdma_1_1ptdma__plan__many}{pascal\+\_\+tdma\+::ptdma\+\_\+plan\+\_\+many}}
\begin{DoxyCompactList}\small\item\em Execution plan for many tridiagonal systems of equations. \end{DoxyCompactList}\item 
type \mbox{\hyperlink{structpascal__tdma_1_1ptdma__plan__single}{pascal\+\_\+tdma\+::ptdma\+\_\+plan\+\_\+single}}
\begin{DoxyCompactList}\small\item\em Execution plan for a single tridiagonal system of equations. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Modules}
\begin{DoxyCompactItemize}
\item 
module \mbox{\hyperlink{namespacepascal__tdma}{pascal\+\_\+tdma}}
\begin{DoxyCompactList}\small\item\em Module for Pa\+Sca\+L-\/\+T\+D\+MA library. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine, public \mbox{\hyperlink{namespacepascal__tdma_a5dfc2d7c919b47ad364a74d141532a9f}{pascal\+\_\+tdma\+::pascal\+\_\+tdma\+\_\+plan\+\_\+single\+\_\+create}} (plan, myrank, nprocs, mpi\+\_\+world, gather\+\_\+rank)
\begin{DoxyCompactList}\small\item\em Create a plan for a single tridiagonal system of equations. \end{DoxyCompactList}\item 
subroutine, public \mbox{\hyperlink{namespacepascal__tdma_adb04e59c740ce6c4b9518dd86eaeb594}{pascal\+\_\+tdma\+::pascal\+\_\+tdma\+\_\+plan\+\_\+single\+\_\+destroy}} (plan)
\begin{DoxyCompactList}\small\item\em Deallocate the allocated arrays in the defined plan\+\_\+single. \end{DoxyCompactList}\item 
subroutine, public \mbox{\hyperlink{namespacepascal__tdma_a7e9c24b343ae949044eccc8692dcc6e9}{pascal\+\_\+tdma\+::pascal\+\_\+tdma\+\_\+plan\+\_\+many\+\_\+create}} (plan, n\+\_\+sys, myrank, nprocs, mpi\+\_\+world)
\begin{DoxyCompactList}\small\item\em Create a plan for many tridiagonal systems of equations. \end{DoxyCompactList}\item 
subroutine, public \mbox{\hyperlink{namespacepascal__tdma_a8438e6774617871b147af9ec8bdad6ce}{pascal\+\_\+tdma\+::pascal\+\_\+tdma\+\_\+plan\+\_\+many\+\_\+destroy}} (plan)
\begin{DoxyCompactList}\small\item\em Destroy the allocated arrays in the defined plan\+\_\+many. \end{DoxyCompactList}\item 
subroutine, public \mbox{\hyperlink{namespacepascal__tdma_ab14e132231d4b53fd65dd333ccc85a50}{pascal\+\_\+tdma\+::pascal\+\_\+tdma\+\_\+single\+\_\+solve}} (plan, A, B, C, D, n\+\_\+row)
\begin{DoxyCompactList}\small\item\em Solve a single tridiagonal system of equation. \end{DoxyCompactList}\item 
subroutine, public \mbox{\hyperlink{namespacepascal__tdma_ac8e377fa86c75126380f0196f6046043}{pascal\+\_\+tdma\+::pascal\+\_\+tdma\+\_\+single\+\_\+solve\+\_\+cycle}} (plan, A, B, C, D, n\+\_\+row)
\begin{DoxyCompactList}\small\item\em Solve a single cyclic tridiagonal system of equations. \end{DoxyCompactList}\item 
subroutine, public \mbox{\hyperlink{namespacepascal__tdma_afa0c78b8377f5fe1059907befda3c940}{pascal\+\_\+tdma\+::pascal\+\_\+tdma\+\_\+many\+\_\+solve}} (plan, A, B, C, D, n\+\_\+sys, n\+\_\+row)
\begin{DoxyCompactList}\small\item\em Solve many tridiagonal systems of equations. \end{DoxyCompactList}\item 
subroutine, public \mbox{\hyperlink{namespacepascal__tdma_acbaed65e67ecbfd92a8f1d51d1b69fd5}{pascal\+\_\+tdma\+::pascal\+\_\+tdma\+\_\+many\+\_\+solve\+\_\+cycle}} (plan, A, B, C, D, n\+\_\+sys, n\+\_\+row)
\begin{DoxyCompactList}\small\item\em Solve many cyclic tridiagonal systems of equations. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Pa\+Sca\+L\+\_\+\+T\+D\+MA -\/ Parallel and Scalable Library for Tri-\/\+Diagonal Matrix Algorithm Pa\+Scal\+\_\+\+T\+D\+MA solves many tridiagonal systems of equations in a parallel manner using a noble all-\/to-\/all communication scheme with the modified Thomas algorithm by Laszlo et al(2016). 

This module is for both of a single and many tridiagonal systems of equations. The main algorithm consists of the following five steps\+: (1) Transform the original partitioned tridiagonal systems of equations The original partitioned tridiagonal system of equations is transformed to the modified tridiagonal system using the modified Thomas algorithm. (2) Build the reduced tridiagonal systems of equations The first and last rows of the modified tridiagonal systems are assembled by executing the proposed all-\/to-\/all communication scheme and the reduced tridiagonal systems are built. (3) Solve the reduced tridiagonal systems The reduced tridiagonal systems are solved by applying Thomas algorithm. (4) Distribute the solutions of the reduced tridiagonal systems The solutions in Step 3 are distributed to each computing cores by executing the inverse of the all-\/to-\/all communication in Step 2. (5) Update the solutions in the modified tridiagonal systems The remaining unknows are updated using the modified tridiagonal systems with the solutions obtained in Step 3 and Step 4.

Step 1 and Step 5 are similar to the method proposed by Laszlo, Gilles and Appleyard(2016) which used the parallel cyclic reduction (P\+CR) to build and solve the reduced tridiagonal systems. Instead of using the P\+CR, we develop an all-\/to-\/all communication scheme using a M\+P\+I\+\_\+\+Ialltoall function after the modified Thomas algorithm is execued. The number of coefficients for the reduced tridiagonal systems are greatly reduced, so we can avoid the communication bandwidth problem which is a main bottle-\/neck of all-\/to-\/all communications. Our algorithm is also distinguished from the work of Mattor, Williams, Hewette (1995) which assembles the undetermined coefficients of the temporary solutions in a single processor using M\+P\+I\+\_\+\+Gather, where load imbalances are serious.

\begin{DoxyAuthor}{Author}

\end{DoxyAuthor}

\begin{DoxyItemize}
\item Kiha Kim (\href{mailto:k-kiha@yonsei.ac.kr}{\texttt{ k-\/kiha@yonsei.\+ac.\+kr}}), Department of Computational Science \& Engineering, Yonsei University
\item Ji-\/\+Hoon Kang (\href{mailto:jhkang@kisti.re.kr}{\texttt{ jhkang@kisti.\+re.\+kr}}), Korea Institute of Science and Technology Information
\item Jung-\/\+Il Choi (\href{mailto:jic@yonsei.ac.kr}{\texttt{ jic@yonsei.\+ac.\+kr}}), Department of Computational Science \& Engineering, Yonsei University
\end{DoxyItemize}

\begin{DoxyDate}{Date}
June 2019 
\end{DoxyDate}
\begin{DoxyVersion}{Version}
1.\+0 
\end{DoxyVersion}
\begin{DoxyParagraph}{Copyright}
Copyright (c) 2019 Kiha Kim and Jung-\/\+Il choi, Yonsei University and Ji-\/\+Hoon Kang, Korea Institute of Science and Technology Information, All rights reserved. 
\end{DoxyParagraph}
\begin{DoxyParagraph}{License }

\end{DoxyParagraph}
This project is release under the terms of the M\+IT License (see L\+I\+C\+E\+N\+SE in ) 