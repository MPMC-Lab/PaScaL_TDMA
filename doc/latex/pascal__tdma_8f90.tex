\hypertarget{pascal__tdma_8f90}{}\section{/\+Users/jihoon/\+Documents/develop/pascal\+\_\+tdma/src/pascal\+\_\+tdma.f90 File Reference}
\label{pascal__tdma_8f90}\index{/Users/jihoon/Documents/develop/pascal\_tdma/src/pascal\_tdma.f90@{/Users/jihoon/Documents/develop/pascal\_tdma/src/pascal\_tdma.f90}}


Pa\+Sca\+L\+\_\+\+T\+D\+MA -\/ Parallel and Scalable Library for Tri\+Diagonal Matrix Algorithm.  


\subsection*{Data Types}
\begin{DoxyCompactItemize}
\item 
type \mbox{\hyperlink{structpascal__tdma_1_1ptdma__plan__many}{pascal\+\_\+tdma\+::ptdma\+\_\+plan\+\_\+many}}
\begin{DoxyCompactList}\small\item\em Execution plan for many tridiagonal systems of equations. \end{DoxyCompactList}\item 
type \mbox{\hyperlink{structpascal__tdma_1_1ptdma__plan__single}{pascal\+\_\+tdma\+::ptdma\+\_\+plan\+\_\+single}}
\begin{DoxyCompactList}\small\item\em Execution plan for a single tridiagonal system of equations. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Modules}
\begin{DoxyCompactItemize}
\item 
module \mbox{\hyperlink{namespacepascal__tdma}{pascal\+\_\+tdma}}
\begin{DoxyCompactList}\small\item\em Module for Pa\+Sca\+L-\/\+T\+D\+MA library. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine, public \mbox{\hyperlink{namespacepascal__tdma_a5dfc2d7c919b47ad364a74d141532a9f}{pascal\+\_\+tdma\+::pascal\+\_\+tdma\+\_\+plan\+\_\+single\+\_\+create}} (plan, myrank, nprocs, mpi\+\_\+world, gather\+\_\+rank)
\begin{DoxyCompactList}\small\item\em Create a plan for a single tridiagonal system of equations. \end{DoxyCompactList}\item 
subroutine, public \mbox{\hyperlink{namespacepascal__tdma_adb04e59c740ce6c4b9518dd86eaeb594}{pascal\+\_\+tdma\+::pascal\+\_\+tdma\+\_\+plan\+\_\+single\+\_\+destroy}} (plan)
\begin{DoxyCompactList}\small\item\em Deallocate the allocated arrays in the defined plan\+\_\+single . \end{DoxyCompactList}\item 
subroutine, public \mbox{\hyperlink{namespacepascal__tdma_a7e9c24b343ae949044eccc8692dcc6e9}{pascal\+\_\+tdma\+::pascal\+\_\+tdma\+\_\+plan\+\_\+many\+\_\+create}} (plan, n\+\_\+sys, myrank, nprocs, mpi\+\_\+world)
\begin{DoxyCompactList}\small\item\em Create a plan for many tridiagonal systems of equations. \end{DoxyCompactList}\item 
subroutine, public \mbox{\hyperlink{namespacepascal__tdma_a8438e6774617871b147af9ec8bdad6ce}{pascal\+\_\+tdma\+::pascal\+\_\+tdma\+\_\+plan\+\_\+many\+\_\+destroy}} (plan)
\begin{DoxyCompactList}\small\item\em Destroy the allocated arrays in the defined plan\+\_\+many. \end{DoxyCompactList}\item 
subroutine, public \mbox{\hyperlink{namespacepascal__tdma_ab14e132231d4b53fd65dd333ccc85a50}{pascal\+\_\+tdma\+::pascal\+\_\+tdma\+\_\+single\+\_\+solve}} (plan, A, B, C, D, n\+\_\+row)
\begin{DoxyCompactList}\small\item\em Solve a single tridiagonal system of equation. \end{DoxyCompactList}\item 
subroutine, public \mbox{\hyperlink{namespacepascal__tdma_ac8e377fa86c75126380f0196f6046043}{pascal\+\_\+tdma\+::pascal\+\_\+tdma\+\_\+single\+\_\+solve\+\_\+cycle}} (plan, A, B, C, D, n\+\_\+row)
\begin{DoxyCompactList}\small\item\em Solve a single cyclic tridiagonal system of equations. \end{DoxyCompactList}\item 
subroutine, public \mbox{\hyperlink{namespacepascal__tdma_afa0c78b8377f5fe1059907befda3c940}{pascal\+\_\+tdma\+::pascal\+\_\+tdma\+\_\+many\+\_\+solve}} (plan, A, B, C, D, n\+\_\+sys, n\+\_\+row)
\begin{DoxyCompactList}\small\item\em Solve many tridiagonal systems of equations. \end{DoxyCompactList}\item 
subroutine, public \mbox{\hyperlink{namespacepascal__tdma_acbaed65e67ecbfd92a8f1d51d1b69fd5}{pascal\+\_\+tdma\+::pascal\+\_\+tdma\+\_\+many\+\_\+solve\+\_\+cycle}} (plan, A, B, C, D, n\+\_\+sys, n\+\_\+row)
\begin{DoxyCompactList}\small\item\em Solve many cyclic tridiagonal systems of equations. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Pa\+Sca\+L\+\_\+\+T\+D\+MA -\/ Parallel and Scalable Library for Tri\+Diagonal Matrix Algorithm. 

Pa\+Scal\+\_\+\+T\+D\+MA provides an efficient and scalable computational procedure to solve many tridiagonal systems in multi-\/dimensional partial differential equations. The modified Thomas algorithm proposed by Laszlo et al.(2016) and the newly designed communication scheme have been used to reduce the communication overhead in solving many tridiagonal systems. This library is for both single and many tridiagonal systems of equations. The main algorithm for a tridiagonal matrix consists of the following five steps\+:

(1) Transform the partitioned submatrices in the tridiagonal systems into modified submatrices\+: Each computing core transforms the partitioned submatrices in the tridiagonal systems of equations into modified forms by applying the modified Thomas algorithm. (2) Construct reduced tridiagonal systems from the modified submatrices\+: The reduced tridiagonal systems are constructed by collecting the first and last rows of the modified submatrices from each core using M\+P\+I\+\_\+\+Ialltoallw. (3) Solve the reduced tridiagonal systems\+: The reduced tridiagonal systems constructed in Step 2 are solved by applying the Thomas algorithm. (4) Distribute the solutions of the reduced tridiagonal systems\+: The solutions of the reduced tridiagonal systems in Step 3 are distributed to each core using M\+P\+I\+\_\+\+Ialltoallw. This communication is an exact inverse of the communication in Step 2. (5) Update the other unknowns in the modified tridiagonal systems\+: The remaining unknowns in the modified submatrices in Step 1 are solved in each computing core using the solutions obtained in Step 3 and Step 4.

Step 1 and Step 5 are similar to the method proposed by Laszlo et al.(2016) which uses parallel cyclic reduction (P\+CR) algorithm to build and solve the reduced tridiagonal systems. Instead of using the P\+CR, we develop an all-\/to-\/all communication scheme using the M\+P\+I\+\_\+\+Ialltoall function after the modified Thomas algorithm is executed. The number of coefficients for the reduced tridiagonal systems are greatly reduced, so we can avoid the communication bandwidth problem, which is a main bottleneck for all-\/to-\/all communications. Our algorithm is also distinguished from the work of Mattor et al. (1995) which assembles the undetermined coefficients of the temporary solutions in a single processor using M\+P\+I\+\_\+\+Gather, where load imbalances are serious.

\begin{DoxyAuthor}{Author}

\end{DoxyAuthor}

\begin{DoxyItemize}
\item Kiha Kim (\href{mailto:k-kiha@yonsei.ac.kr}{\texttt{ k-\/kiha@yonsei.\+ac.\+kr}}), Department of Computational Science \& Engineering, Yonsei University
\item Ji-\/\+Hoon Kang (\href{mailto:jhkang@kisti.re.kr}{\texttt{ jhkang@kisti.\+re.\+kr}}), Korea Institute of Science and Technology Information
\item Jung-\/\+Il Choi (\href{mailto:jic@yonsei.ac.kr}{\texttt{ jic@yonsei.\+ac.\+kr}}), Department of Computational Science \& Engineering, Yonsei University
\end{DoxyItemize}

\begin{DoxyDate}{Date}
June 2019 
\end{DoxyDate}
\begin{DoxyVersion}{Version}
1.\+0 
\end{DoxyVersion}
\begin{DoxyParagraph}{Copyright}
Copyright (c) 2019 Kiha Kim and Jung-\/\+Il choi, Yonsei University and Ji-\/\+Hoon Kang, Korea Institute of Science and Technology Information, All rights reserved. 
\end{DoxyParagraph}
\begin{DoxyParagraph}{License }

\end{DoxyParagraph}
This project is released under the terms of the M\+IT License (see L\+I\+C\+E\+N\+SE ) 